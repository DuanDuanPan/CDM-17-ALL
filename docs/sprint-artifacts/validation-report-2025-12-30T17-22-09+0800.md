# Validation Report

**Document:** docs/sprint-artifacts/story-7-5-plugin-migration.md  
**Checklist:** _bmad/bmm/workflows/4-implementation/create-story/checklist.md  
**Date:** 2025-12-30T17:22:09+0800

## Summary
- Overall: 34/86 passed (40%)
- Critical Issues: 5

## Section Results

### Critical Mistakes to Prevent
Pass Rate: 1/8 (13%)

⚠ PARTIAL - Reinventing wheels  
Evidence: Story mandates a "Kernel Loader (Plugin System)" and plugin registration via `PluginManager` (`docs/sprint-artifacts/story-7-5-plugin-migration.md:20-29`) but does not point to the existing implementation in `@cdm/plugins` (`packages/plugins/src/PluginManager.ts:1-95`) nor the existing migration plan (`docs/analysis/refactoring-proposal-2025-12-28.md:164-176`).  
Impact: Developer may re-implement a second loader/protocol or pick inconsistent plugin boundaries.

✗ FAIL - Wrong libraries  
Evidence: Story instructs `pnpm start:dev` and Swagger-based checks (`docs/sprint-artifacts/story-7-5-plugin-migration.md:100-117`), but `apps/api/package.json` has no `start:dev` script (`apps/api/package.json:5-13`) and no Swagger dependency (`apps/api/package.json:15-35`; `rg "Swagger" apps/api/src` finds nothing).  
Impact: Dev follows non-existent commands/tooling; verification becomes unreliable.

✗ FAIL - Wrong file locations  
Evidence: Story moves Nest modules into `packages/plugins/plugin-mindmap-core/src/server/*` (`docs/sprint-artifacts/story-7-5-plugin-migration.md:58-60,315-326`), but current `@cdm/plugin-mindmap-core` is a frontend/X6 plugin (`packages/plugins/plugin-mindmap-core/src/index.ts:1-18`) and the refactoring proposal recommends dedicated backend plugins (`docs/analysis/refactoring-proposal-2025-12-28.md:164-176`).  
Impact: High risk of mixing frontend deps into backend packages and breaking builds/ownership boundaries.

⚠ PARTIAL - Breaking regressions  
Evidence: Parity/no-route-change intent is explicit (`docs/sprint-artifacts/story-7-5-plugin-migration.md:30-34,107-109`) and high-risk deps are called out (`docs/sprint-artifacts/story-7-5-plugin-migration.md:203-268`), but API examples omit global `/api` prefix (`apps/api/src/main.ts:10-12`) and smoke-test method assumes Swagger exists.  
Impact: Good intent, but missing exact verification paths can allow regressions.

✓ PASS - Ignoring UX  
Evidence: Story explicitly requires identical API behavior and no route changes (`docs/sprint-artifacts/story-7-5-plugin-migration.md:30-34,107-109`).  
Impact: Keeps user-facing behavior as the primary constraint.

⚠ PARTIAL - Vague implementations  
Evidence: Critical wiring steps are underspecified (e.g., "Fix imports" and "Verify Kernel Loader works" without concrete Nest/plugin integration) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:65-75`).  
Impact: Dev may implement incompatible wiring or miss cross-module exports.

⚠ PARTIAL - Lying about completion  
Evidence: Acceptance criteria are clear, but verification relies on non-existent commands/tooling and includes incorrect inventory numbers (`docs/sprint-artifacts/story-7-5-plugin-migration.md:100-117,150-155`).  
Impact: Story can be marked "done" without strong evidence of parity.

✗ FAIL - Not learning from past work  
Evidence: Existing migration plan already defines plugin targets and ordering (`docs/analysis/refactoring-proposal-2025-12-28.md:164-176`), and Story 7.4 post-review stresses accuracy and avoiding non-existent file claims (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:61-69`), yet Story 7.5 diverges (reusing plugin-mindmap-core for backend) and contains inaccurate module file counts (`docs/sprint-artifacts/story-7-5-plugin-migration.md:150-155`).  
Impact: Repeats known failure modes (wrong targets, inaccurate guidance) and increases implementation risk.

### Step 1: Load and Understand the Target
Pass Rate: 6/6 (100%)

✓ PASS - Load the workflow configuration  
Evidence: `_bmad/bmm/workflows/4-implementation/create-story/workflow.yaml:1-32` defines workflow variables and validation checklist.

✓ PASS - Load the story file  
Evidence: Story content present in `docs/sprint-artifacts/story-7-5-plugin-migration.md:1-511`.

✓ PASS - Load validation framework  
Evidence: `_bmad/core/tasks/validate-workflow.xml:1-59` defines the validation process and report format.

✓ PASS - Extract metadata (epic/story key)  
Evidence: Title includes "Story 7.5" (`docs/sprint-artifacts/story-7-5-plugin-migration.md:1`), epic context in `docs/epics.md:624-699`.

✓ PASS - Resolve workflow variables  
Evidence: Output folder is `docs` (`_bmad/bmm/config.yaml:1-12`); story artifact folder is `docs/sprint-artifacts` (document path provided).

✓ PASS - Understand current status  
Evidence: Status is "ready-for-dev" (`docs/sprint-artifacts/story-7-5-plugin-migration.md:3`).

### Step 2.1: Epics and Stories Analysis
Pass Rate: 3/5 (60%)

✓ PASS - Epic objectives and business value  
Evidence: Epic 7 goal is architecture alignment and debt paydown (`docs/epics.md:624-627`).

✓ PASS - All stories in this epic  
Evidence: Epic 7 stories 7.1–7.6 listed (`docs/epics.md:628-713`).

✓ PASS - Specific story requirements and acceptance criteria  
Evidence: Epic 7.5 requirements in `docs/epics.md:685-698` and expanded ACs in story (`docs/sprint-artifacts/story-7-5-plugin-migration.md:13-38`).

⚠ PARTIAL - Technical requirements and constraints  
Evidence: Refactoring proposal specifies a different plugin decomposition/sequence (`docs/analysis/refactoring-proposal-2025-12-28.md:164-176`) than Story 7.5 ("plugin-mindmap-core" boundary) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:15-19,44-60`).  
Impact: Conflicting constraints can lead to wrong plugin APIs and dependency boundaries.

⚠ PARTIAL - Cross-story dependencies and prerequisites  
Evidence: Story identifies cross-module deps (Collab→NodeRepository, Approval↔Nodes) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:203-268`) but does not explicitly state prerequisites and sequencing alignment with the refactoring proposal.  
Impact: Dev may proceed without required prerequisites, causing churn.

### Step 2.2: Architecture Deep-Dive
Pass Rate: 9/9 (100%)

✓ PASS - Technical stack with versions  
Evidence: NestJS/Hocuspocus/Yjs versions in `apps/api/package.json:15-35`; TypeScript/Vitest versions in plugin packages (`packages/plugins/plugin-mindmap-core/package.json:1-21`).

✓ PASS - Code structure and organization patterns  
Evidence: "Microkernel + Plugin Protocol" structure rules in `docs/architecture.md:523-579`.

✓ PASS - API design patterns and contracts  
Evidence: Hybrid HTTP/WebSocket pattern (`docs/architecture.md:119-122`) and global `/api` prefix (`apps/api/src/main.ts:10-12`).

✓ PASS - Database schemas and relationships  
Evidence: Core `Node` model + relations in `packages/database/prisma/schema.prisma:74-110`.

✓ PASS - Security requirements and patterns  
Evidence: Clerk + RBAC guard pattern in `docs/architecture.md:114-117`.

✓ PASS - Performance requirements and optimization strategies  
Evidence: Backend "Performance & Reliability" mandates in `docs/architecture.md:688-691`.

✓ PASS - Testing standards and frameworks  
Evidence: Testing mandates in `docs/architecture.md:661-665,693-696`; repo uses Jest for API (`apps/api/package.json:11-13`).

✓ PASS - Deployment and environment patterns  
Evidence: Containerization notes (`docs/architecture.md:131-134`).

✓ PASS - Integration patterns and external services  
Evidence: Hocuspocus/Yjs persistence notes (`docs/architecture.md:108-112`) and `@hocuspocus/server` dependency (`apps/api/package.json:18`).

### Step 2.3: Previous Story Intelligence
Pass Rate: 6/6 (100%)

✓ PASS - Dev notes and learnings  
Evidence: Story 7.4 defines "composition root" and Yjs-first constraints (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:78-120`).

✓ PASS - Review feedback and corrections needed  
Evidence: Story 7.4 includes AI review follow-ups addressing correctness and test integrity (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:61-69`).

✓ PASS - Files created/modified and their patterns  
Evidence: Story 7.1 includes a detailed file change manifest and accuracy audit (`docs/sprint-artifacts/story-7-1-backend-repo-refactor.md:46-108`).

✓ PASS - Testing approaches that worked/didn't work  
Evidence: Story 7.4 requires Playwright E2E and lists existing tests (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:25-47`).

✓ PASS - Problems encountered and solutions found  
Evidence: Story 7.4 documents fixes to E2E failures and plugin event wiring (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:61-69`).

✓ PASS - Code patterns and conventions established  
Evidence: Story 7.4 references SRP, Hook-First and file-size limits in ACs and Dev Notes (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:15-47,78-120`).

### Step 2.4: Git History Analysis
Pass Rate: 5/5 (100%)

✓ PASS - Files created/modified in previous work  
Evidence: Recent commits show Story 7.1 implementation and Story 7.4 completion (`git log -n 10 --oneline`).

✓ PASS - Code patterns and conventions used  
Evidence: Conventional commits + story-scoped changes appear consistently (`git log -n 10 --oneline`).

✓ PASS - Library dependencies added/changed  
Evidence: Recent work includes plugin package test script alignment (`docs/analysis/test-suite-alignment-fix-2025-12-28.md:137-139`).

✓ PASS - Architecture decisions implemented  
Evidence: Epic 7 stories track alignment with backend mandates (`docs/architecture.md:669-696`; Story 7.1 implementation notes in `docs/sprint-artifacts/story-7-1-backend-repo-refactor.md:46-108`).

✓ PASS - Testing approaches used  
Evidence: Repo uses Jest/Vitest/Playwright (`apps/api/package.json:11-13`, `packages/plugins/plugin-mindmap-core/package.json:7-11`, `docs/sprint-artifacts/sprint-status.yaml:42`).

### Step 2.5: Latest Technical Research
Pass Rate: 0/3 (0%)

⚠ PARTIAL - Breaking changes or security updates  
Evidence: Local versions identified (NestJS 11, Hocuspocus 3, TS 5.7) (`apps/api/package.json:18-35`), but no external research captured.  
Impact: Risk of missing breaking changes for NestJS workspace packaging and module resolution.

⚠ PARTIAL - Performance improvements or deprecations  
Evidence: No external/latest research recorded for plugin-loader patterns or NestJS dynamic modules; only local stack references available.  
Impact: May miss recommended packaging patterns (tsconfig paths/exports) for workspace plugins.

⚠ PARTIAL - Best practices for current versions  
Evidence: Story mentions dynamic modules or custom loader in general terms (`docs/sprint-artifacts/story-7-5-plugin-migration.md:127-129`) but does not cite version-specific best practices.  
Impact: Dev may choose a suboptimal plugin integration approach.

### Step 3.1: Reinvention Prevention Gaps
Pass Rate: 0/3 (0%)

✗ FAIL - Wheel reinvention risk  
Evidence: Story requires a Kernel loader but does not specify using the existing `@cdm/plugins` package (`docs/sprint-artifacts/story-7-5-plugin-migration.md:20-29` vs `packages/plugins/src/PluginManager.ts:1-95`).  
Impact: High chance of building a second plugin manager/loader.

✗ FAIL - Code reuse opportunities not identified  
Evidence: Existing refactoring proposal already provides recommended plugin targets and dependency-ordered migration (`docs/analysis/refactoring-proposal-2025-12-28.md:164-176`), but the story does not reference or align to it.  
Impact: Dev may redo analysis work and still pick conflicting boundaries.

✗ FAIL - Existing solutions not mentioned  
Evidence: Existing plugin packages are frontend-oriented (e.g., `@cdm/plugin-mindmap-core` depends on `@antv/x6`) (`packages/plugins/plugin-mindmap-core/package.json:12-16`), but story proposes reusing it for backend server modules (`docs/sprint-artifacts/story-7-5-plugin-migration.md:15-19,58-60`).  
Impact: Creates avoidable coupling and build-risk; better to split client/server plugins explicitly.

### Step 3.2: Technical Specification DISASTERS
Pass Rate: 0/5 (0%)

✗ FAIL - Wrong libraries/frameworks  
Evidence: Story assumes Swagger exists and uses invalid commands/paths (`docs/sprint-artifacts/story-7-5-plugin-migration.md:100-117,354-356`) while repo has no Swagger setup (`apps/api/package.json:15-35`, `rg "Swagger" apps/api/src`).  
Impact: Verification + wiring guidance breaks on day 1.

✗ FAIL - API contract violations  
Evidence: Story's smoke-test endpoints omit global prefix (`docs/sprint-artifacts/story-7-5-plugin-migration.md:110-115`) but API uses `app.setGlobalPrefix('api')` (`apps/api/src/main.ts:10-12`).  
Impact: Manual tests can produce false negatives and route wiring may be misconfigured.

⚠ PARTIAL - Database schema conflicts  
Evidence: Story keeps Prisma schema centralized but does not define how plugins obtain DB access (e.g., shared `PrismaService` module/export) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:34-38,56-57`).  
Impact: Plugins may instantiate DB clients incorrectly or break DI boundaries.

⚠ PARTIAL - Security vulnerabilities  
Evidence: Story says kernel keeps global guards (`docs/sprint-artifacts/story-7-5-plugin-migration.md:20-25`) but does not state that moved controllers must retain the same guards/authorization assumptions.  
Impact: Risk of endpoints becoming unprotected after module relocation.

➖ N/A - Performance disasters  
Evidence: Story is primarily a structural refactor; no new heavy runtime workload is introduced beyond ensuring parity.  
Impact: N/A.

### Step 3.3: File Structure DISASTERS
Pass Rate: 0/4 (0%)

✗ FAIL - Wrong file locations  
Evidence: Story mixes backend Nest modules into existing frontend plugin package path `plugin-mindmap-core` (`docs/sprint-artifacts/story-7-5-plugin-migration.md:58-60`) which currently imports X6 (`packages/plugins/plugin-mindmap-core/src/index.ts:1-18`).  
Impact: Workspace dependency graph and build targets become unclear; increases failure risk.

⚠ PARTIAL - Coding standard violations  
Evidence: Backend mandates require module-per-feature and repository pattern (`docs/architecture.md:671-679`), but story does not explicitly restate these constraints for newly created plugin packages.  
Impact: Plugins may regress to direct Prisma usage or inconsistent structure.

⚠ PARTIAL - Integration pattern breaks  
Evidence: Story identifies the hard dependency `CollabModule -> NodeRepository` (`docs/sprint-artifacts/story-7-5-plugin-migration.md:207-247`) but does not provide a concrete contract/module export plan for kernel modules to depend on plugin repositories without circular imports (current import is `apps/api/src/modules/collab/collab.service.ts:7-8`).  
Impact: DI graph may break or force additional forwardRefs.

⚠ PARTIAL - Deployment failures  
Evidence: Story does not specify build/export strategy for workspace plugin packages (TS path aliases, package `exports`, Nest compilation boundary) while proposing new subpath imports like `@cdm/plugin-mindmap-core/server` (`docs/sprint-artifacts/story-7-5-plugin-migration.md:354-356`).  
Impact: Build may fail due to unresolved paths or bundling.

### Step 3.4: Regression DISASTERS
Pass Rate: 1/4 (25%)

⚠ PARTIAL - Breaking changes  
Evidence: Story mandates parity (`docs/sprint-artifacts/story-7-5-plugin-migration.md:30-34`) but introduces new import paths without defining compatibility guarantees for kernel-only modules (Collab/Graphs) that still need node access (`apps/api/src/modules/collab/collab.service.ts:7-8`).  
Impact: High risk of runtime DI failures and hidden behavior changes.

⚠ PARTIAL - Test failures  
Evidence: Story requires moving unit tests (`docs/sprint-artifacts/story-7-5-plugin-migration.md:91-99`) but does not define test runner setup for new plugin packages (Jest config, tsconfig-paths, moduleNameMapper).  
Impact: Tests may not run or may silently stop covering logic.

✓ PASS - UX violations (not expected)  
Evidence: No user-facing UI behavior is intentionally changed; story enforces API parity and no route changes (`docs/sprint-artifacts/story-7-5-plugin-migration.md:30-34,107-109`).

✗ FAIL - Learning failures  
Evidence: Story does not reference the existing migration decomposition in the refactoring proposal (`docs/analysis/refactoring-proposal-2025-12-28.md:164-176`) and repeats accuracy issues (wrong inventory counts) that prior stories explicitly guarded against (`docs/sprint-artifacts/story-7-4-god-class-splitting.md:61-69`).  
Impact: Avoidable churn and rework.

### Step 3.5: Implementation DISASTERS
Pass Rate: 1/4 (25%)

⚠ PARTIAL - Vague implementations  
Evidence: Several subtasks are placeholders ("Fix imports", "Verify Kernel Loader works") without concrete implementation steps (`docs/sprint-artifacts/story-7-5-plugin-migration.md:65-75`).  
Impact: Dev may implement incomplete migration that passes build but fails runtime.

✗ FAIL - Completion lies  
Evidence: Verification steps cite non-existent tooling (`/api/docs`, `pnpm start:dev`) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:100-117`) and inventory counts are incorrect (`docs/sprint-artifacts/story-7-5-plugin-migration.md:150-155`).  
Impact: Easy to mark story "done" while missing real parity checks.

✓ PASS - Scope creep (bounded)  
Evidence: Out-of-scope follow-ups are clearly marked (`docs/sprint-artifacts/story-7-5-plugin-migration.md:397-452`).

⚠ PARTIAL - Quality failures  
Evidence: Story asks for build/tests but lacks an explicit "definition of done" for plugin loader integration (how plugins are discovered/loaded; how kernel services are shared).  
Impact: Could ship with brittle wiring and hidden coupling.

### Step 4: LLM Optimization Issues
Pass Rate: 1/5 (20%)

✗ FAIL - Verbosity problems  
Evidence: Story contains a full impact analysis + embedded tech spec and repeats similar guidance in multiple places (`docs/sprint-artifacts/story-7-5-plugin-migration.md:144-511`).  
Impact: Dev agent token budget may be wasted; critical instructions become harder to find.

✗ FAIL - Ambiguity issues  
Evidence: Plugin boundary is inconsistent with existing plan (reuse `plugin-mindmap-core` vs `plugin-nodes/plugin-edges`) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:15-19` vs `docs/analysis/refactoring-proposal-2025-12-28.md:164-176`), and API paths omit global prefix (`docs/sprint-artifacts/story-7-5-plugin-migration.md:110-115`).  
Impact: Multiple interpretations likely; higher chance of wrong implementation.

✗ FAIL - Context overload  
Evidence: Includes multiple long sections (Impact Analysis, migration checklists, tech spec) without prioritization for execution order (`docs/sprint-artifacts/story-7-5-plugin-migration.md:144-511`).  
Impact: Dev may miss key blockers buried mid-document.

✗ FAIL - Missing critical signals  
Evidence: Story never states "Swagger is not configured" (but recommends it) and never points to the existing `@cdm/plugins` implementation for the required PluginManager/loader (`docs/sprint-artifacts/story-7-5-plugin-migration.md:100-117,20-29`).  
Impact: Dev will lose time on dead ends.

✓ PASS - Poor structure (not observed)  
Evidence: Clear headings, numbered tasks, and explicit ACs are present (`docs/sprint-artifacts/story-7-5-plugin-migration.md:7-86`).

### Step 4: LLM Optimization Principles
Pass Rate: 1/5 (20%)

✗ FAIL - Clarity over verbosity  
Evidence: Important decisions (plugin boundary naming, loader integration) are diluted by large appended analysis (`docs/sprint-artifacts/story-7-5-plugin-migration.md:144-511`).  
Impact: Low signal-to-noise.

⚠ PARTIAL - Actionable instructions  
Evidence: Many tasks are actionable (move dirs, update deps) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:42-85`), but core wiring details and exact commands are wrong/ambiguous (`docs/sprint-artifacts/story-7-5-plugin-migration.md:100-105`).  
Impact: Implementation likely needs extra discovery.

✓ PASS - Scannable structure  
Evidence: The document is structured with sections, task lists, and tables (`docs/sprint-artifacts/story-7-5-plugin-migration.md:13-86,144-211`).

✗ FAIL - Token efficiency  
Evidence: Duplicated planning content (Tasks + file migration checklist + embedded tech spec) repeats the same ideas (`docs/sprint-artifacts/story-7-5-plugin-migration.md:40-86,315-392,455-511`).  
Impact: Extra tokens without added constraints.

✗ FAIL - Unambiguous language  
Evidence: Uses non-existent module names/paths (`MindmapCoreModule`, `@cdm/plugin-mindmap-core/server`) and ambiguous endpoint paths (`/nodes` vs `/api/nodes`) (`docs/sprint-artifacts/story-7-5-plugin-migration.md:60,354-356,110-115`).  
Impact: Dev may implement wrong imports/routes.

### Step 5: Improvement Recommendations (Meta)
Pass Rate: 0/4 (0%)

➖ N/A - 5.1 Critical Misses (Must Fix)  
Evidence: Meta instruction for validator.

➖ N/A - 5.2 Enhancement Opportunities (Should Add)  
Evidence: Meta instruction for validator.

➖ N/A - 5.3 Optimization Suggestions (Nice to Have)  
Evidence: Meta instruction for validator.

➖ N/A - 5.4 LLM Optimization Improvements  
Evidence: Meta instruction for validator.

### Competition Success Metrics (Meta)
Pass Rate: 0/3 (0%)

➖ N/A - Category 1: Critical Misses (Blockers)  
Evidence: Meta success metric.

➖ N/A - Category 2: Enhancement Opportunities  
Evidence: Meta success metric.

➖ N/A - Category 3: Optimization Insights  
Evidence: Meta success metric.

### Interactive Improvement Process (Meta)
Pass Rate: 0/4 (0%)

➖ N/A - Step 5: Present Improvement Suggestions  
Evidence: Process guidance for follow-up.

➖ N/A - Step 6: Interactive User Selection  
Evidence: Process guidance for follow-up.

➖ N/A - Step 7: Apply Selected Improvements  
Evidence: Process guidance for follow-up.

➖ N/A - Step 8: Confirmation  
Evidence: Process guidance for follow-up.

### Competitive Excellence Mindset (Meta)
Pass Rate: 0/3 (0%)

➖ N/A - Success Criteria for improved stories  
Evidence: Motivational guidance.

➖ N/A - "Every improvement should make it impossible" guidance  
Evidence: Motivational guidance.

➖ N/A - LLM Optimization "impossible" guidance  
Evidence: Motivational guidance.

## Failed Items
1) Wrong libraries — Replace `pnpm start:dev`/Swagger references with actual repo scripts and verification paths; if Swagger is required, add it explicitly.
2) Wrong file locations — Do not move backend modules into `@cdm/plugin-mindmap-core` (frontend/X6 plugin). Align backend migration to dedicated plugins per `docs/analysis/refactoring-proposal-2025-12-28.md`.
3) Not learning from past work — Reference and align with the existing migration plan + prior Epic 7 learnings (accuracy, test integrity).
4) Wheel reinvention risk — Explicitly mandate using `@cdm/plugins` (PluginManager) OR explicitly declare a different approved loader and where it lives.
5) Code reuse opportunities not identified — Incorporate the refactoring proposal’s target plugin list and dependency-ordered migration plan.
6) Existing solutions not mentioned — Call out that existing plugins are frontend-oriented and must not be repurposed without a clear client/server split.
7) Wrong libraries/frameworks (Step 3.2) — Remove invalid `@cdm/plugin-*/server` imports until package `exports` exist; correct commands (`apps/api` has no `start:dev`).
8) API contract violations — Fix endpoint examples to include global `/api` prefix (or explicitly state how routing is preserved).
9) Wrong file locations (Step 3.3) — Define a consistent folder/package layout for backend plugins (e.g., `packages/plugins/plugin-nodes/src/server/*`) without mixing frontend deps.
10) Learning failures (Step 3.4) — Update story to match Epic 7 migration planning docs and remove inaccurate analysis.
11) Completion lies (Step 3.5) — Replace verification steps with runnable commands and real smoke-test tooling (curl/Postman, or add Swagger).
12) Verbosity problems — Move long impact analysis into a separate doc or collapse to a short “Top 5 risks + mitigation”.
13) Ambiguity issues — Decide and state canonical plugin boundaries/names (plugin-nodes, plugin-edges, etc) and do not suggest multiple conflicting targets.
14) Context overload — Add a “Do this first” execution order with the minimum required steps for success.
15) Missing critical signals — Add explicit notes: “Swagger not configured”, “global /api prefix”, “do not use plugin-mindmap-core for backend”.
16) Clarity over verbosity — Rewrite key requirements into short bullets and remove duplicated sections.
17) Token efficiency — De-duplicate Tasks vs Tech-Spec vs migration checklist; keep one source of truth.
18) Unambiguous language — Replace placeholder module names/paths with concrete existing files + new package export plan.

## Partial Items
1) Reinventing wheels — Point to `@cdm/plugins` + refactoring proposal to reduce duplicate discovery work.
2) Breaking regressions — Tighten smoke tests (prefix, routes) and add explicit rollback/verification steps.
3) Vague implementations — Add explicit wiring steps for kernel-only modules that still need plugin services (Collab/Graphs).
4) Lying about completion — Fix module inventory counts or remove them; ensure verification steps are executable.
5) Technical requirements/constraints — Reconcile Story 7.5 vs refactoring proposal decomposition.
6) Cross-story dependencies — Explicitly list prerequisites (e.g., repository exports, kernel module boundaries).
7) Latest research: breaking changes/security updates — Validate NestJS 11 workspace packaging patterns if relying on dynamic modules/subpath exports.
8) Latest research: performance/deprecations — Check best practices for plugin discovery/load order and DI boundaries.
9) Latest research: best practices — Add recommended approach (static Nest imports vs dynamic loader) for this repo’s current state.
10) Database schema conflicts — Define a shared `DatabaseModule`/`PrismaService` export strategy for plugins.
11) Security vulnerabilities — State guard expectations for moved controllers (RBAC/auth must remain enforced).
12) Coding standard violations — Restate backend mandates for new plugin packages (repo pattern, module-per-feature).
13) Integration pattern breaks — Provide an explicit contract for Collab→Nodes access post-migration.
14) Deployment failures — Define tsconfig paths + package `exports` and how `nest build` will consume workspace plugins.
15) Breaking changes — Add explicit “API routes unchanged” mapping including global prefix behavior.
16) Test failures — Add concrete test runner approach for new plugin packages (Jest config reuse or per-plugin Jest).
17) Vague implementations (Step 3.5) — Add exact file-level tasks for plugin loader + AppModule imports.
18) Quality failures — Add Definition of Done (build + unit tests + runtime boot + smoke endpoints).
19) Actionable instructions — Fix invalid commands and make all tasks point to real files and scripts.

## Recommendations
1. Must Fix: Align plugin decomposition with `docs/analysis/refactoring-proposal-2025-12-28.md` (plugin-nodes/plugin-edges/plugin-workflow-approval/plugin-comments), and explicitly forbid mixing backend modules into frontend plugin packages like `@cdm/plugin-mindmap-core`. Replace invalid commands/tooling (Swagger/start:dev) with executable verification steps and correct API paths (global `/api` prefix).
2. Should Improve: Add explicit kernel↔plugin contracts (DB/Prisma access module export; Collab/Graphs dependency strategy), test-runner setup for new plugin packages, and clear security/guard expectations.
3. Consider: Reduce verbosity by extracting long impact analysis/tech spec to a separate doc and keeping the story as an execution-ready checklist with the minimum necessary context.

