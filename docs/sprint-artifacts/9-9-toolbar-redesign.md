# Story 9.9: æ•°æ®èµ„æºåº“ Toolbar é‡è®¾è®¡ (Data Library Toolbar Redesign)

Status: done

## Story

As a **ç”¨æˆ·**,
I want **åœ¨æ•°æ®èµ„æºåº“ä¸­ä½¿ç”¨ç²¾ç®€çš„æ“ä½œç±» Toolbar å’Œç‹¬ç«‹çš„èµ„äº§ç­›é€‰æ **,
so that **æˆ‘èƒ½æ¸…æ™°åŒºåˆ†"èŠ‚ç‚¹æœç´¢"ä¸"èµ„äº§æœç´¢"ï¼Œå¹¶åœ¨ä¸åŒè§†è§’ä¸‹è·å¾—ä¸€è‡´çš„ç­›é€‰ä½“éªŒã€‚**

## èƒŒæ™¯

åœ¨å®Œæˆ Story 9.8ï¼ˆèŠ‚ç‚¹è§†å›¾åˆå¹¶ï¼‰åï¼Œæ•°æ®èµ„æºåº“ Toolbar å­˜åœ¨ä»¥ä¸‹äº¤äº’é—®é¢˜ï¼š

1. **æœç´¢åŠŸèƒ½é‡å ä¸æ­§ä¹‰**ï¼šå·¦ä¾§èŠ‚ç‚¹é¢æ¿æœç´¢èŠ‚ç‚¹ï¼Œé¡¶éƒ¨ Toolbar æœç´¢èµ„äº§ï¼Œç”¨æˆ·å®¹æ˜“æ··æ·†
2. **é«˜çº§ç­›é€‰æ— æ³•å¤ç”¨**ï¼šåˆ‡æ¢è§†è§’åç­›é€‰è¡Œä¸ºä¸ä¸€è‡´ï¼ŒUI æœªæ˜ç¡®è¡¨è¾¾ç­›é€‰èŒƒå›´
3. **è§†è§‰å±‚æ¬¡æ··ä¹±**ï¼šæ“ä½œç±»ã€ç­›é€‰ç±»ã€è§†å›¾æ§åˆ¶ç±»æŒ‰é’®æ··åˆåœ¨å•è¡Œ Toolbar ä¸­ï¼ŒåŠŸèƒ½å¯†åº¦è¿‡é«˜

## Acceptance Criteria

### AC1: Toolbar ç²¾ç®€ï¼ˆæ“ä½œç±»èšç„¦ï¼‰

**Given** æ•°æ®èµ„æºåº“ Drawer å·²æ‰“å¼€
**When** æŸ¥çœ‹é¡¶éƒ¨ Toolbar
**Then** åº”åªåŒ…å«æ“ä½œç±»æ§ä»¶ï¼šä¸Šä¼ æŒ‰é’®ã€æ‰¹é‡åˆ é™¤æŒ‰é’®ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰ã€å›æ”¶ç«™æŒ‰é’®ã€è§†å›¾åˆ‡æ¢ã€å·¦ä¾§é¢æ¿ Toggle
**And** æœç´¢è¾“å…¥æ¡†ã€ç±»å‹ç­›é€‰ä¸‹æ‹‰ã€æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨åº”ä» Toolbar ç§»é™¤
**And** Toolbar é«˜åº¦ â‰¤ 56pxï¼Œæ§ä»¶æ•°é‡ â‰¤ 6 ä¸ª

### AC2: èµ„äº§ç­›é€‰æ ï¼ˆAsset Filter Barï¼‰

**Given** æ•°æ®èµ„æºåº“ Drawer å·²æ‰“å¼€
**When** æŸ¥çœ‹å†…å®¹åŒºé¡¶éƒ¨
**Then** åº”æ˜¾ç¤ºç‹¬ç«‹çš„èµ„äº§ç­›é€‰æ ï¼ŒåŒ…å«ï¼šæœç´¢è¾“å…¥æ¡†ã€æœç´¢èŒƒå›´é€‰æ‹©å™¨ã€ç±»å‹ç­›é€‰ä¸‹æ‹‰ã€æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ã€æ¸…é™¤ç­›é€‰æŒ‰é’®
**And** ç­›é€‰æ é«˜åº¦ â‰¤ 48px
**And** æœç´¢è¾“å…¥æœ‰ 300ms debounce
**And** ç­›é€‰ç»“æœå®æ—¶æ›´æ–°ï¼ˆæ— éœ€æ‰‹åŠ¨åˆ·æ–°ï¼‰
**And** ç­›é€‰æ¡ä»¶å˜åŒ–æ—¶æ˜¾ç¤ºã€Œå·²åº”ç”¨ N ä¸ªç­›é€‰ã€å¾½ç« 

### AC3: æœç´¢èŒƒå›´é€‰æ‹©å™¨ï¼ˆScope Selectorï¼‰

**Given** èµ„äº§ç­›é€‰æ å¤„äºæ¿€æ´»çŠ¶æ€
**When** æŸ¥çœ‹æœç´¢èŒƒå›´é€‰æ‹©å™¨
**Then** åº”æ˜¾ç¤ºä¸‰ä¸ªé€‰é¡¹ï¼š`å½“å‰èŠ‚ç‚¹`ï¼ˆé»˜è®¤ï¼‰ã€`å…¨éƒ¨èµ„äº§`ã€`æœªå…³è”èµ„äº§`
**And** åˆ‡æ¢èŒƒå›´åæœç´¢ç»“æœç«‹å³åˆ·æ–°
**And** é€‰æ‹©ã€Œå…¨éƒ¨èµ„äº§ã€æ—¶éšè— linkType åˆ†ç»„ï¼ˆå› ä¸ºä¸å†æŒ‰èŠ‚ç‚¹è¿‡æ»¤ï¼‰

### AC4: ç­›é€‰çŠ¶æ€è¡Œä¸ºï¼ˆFilter State Behaviorï¼‰

**Given** ç”¨æˆ·åœ¨èŠ‚ç‚¹è§†å›¾ä¸­è®¾ç½®äº†ç­›é€‰æ¡ä»¶ï¼ˆæœç´¢å…³é”®è¯ã€ç±»å‹ã€æ—¥æœŸï¼‰
**When** åˆ‡æ¢èŠ‚ç‚¹ï¼ˆåŒè§†è§’å†…ï¼‰
**Then** ç­›é€‰æ¡ä»¶ä¿æŒä¸å˜ï¼Œåº”ç”¨åˆ°æ–°èŠ‚ç‚¹

**When** åˆ‡æ¢è§†è§’ï¼ˆèŠ‚ç‚¹â†”æ–‡ä»¶å¤¹ï¼‰
**Then** æ‰€æœ‰ç­›é€‰æ¡ä»¶æ¸…ç©º
**And** æ˜¾ç¤º Toast æç¤ºã€Œç­›é€‰å·²é‡ç½®ã€

**When** å…³é—­/é‡æ–°æ‰“å¼€ Drawer
**Then** ç­›é€‰æ¡ä»¶ä¿æŒï¼ˆä¼šè¯å†…ï¼‰

**When** åˆ·æ–°é¡µé¢
**Then** ç­›é€‰æ¡ä»¶æ¸…ç©ºï¼ˆä¸æŒä¹…åŒ–ï¼‰

### AC5: å·¦ä¾§èŠ‚ç‚¹æœç´¢å¢å¼º

**Given** èŠ‚ç‚¹è§†å›¾å¤„äºæ¿€æ´»çŠ¶æ€
**When** æŸ¥çœ‹å·¦ä¾§ç»„ç»‡é¢æ¿çš„æœç´¢æ¡†
**Then** æœç´¢è¾“å…¥æ¡†ä¸‹æ–¹æ˜¾ç¤ºã€Œåœ¨ PBS å’Œä»»åŠ¡èŠ‚ç‚¹ä¸­æœç´¢ã€å¸®åŠ©æç¤º
**And** èŠ‚ç‚¹æœç´¢ä¿æŒç°æœ‰åŠŸèƒ½ï¼šæŒ‰èŠ‚ç‚¹åç§°æœç´¢ã€é«˜äº®åŒ¹é…æ–‡æœ¬ã€è‡ªåŠ¨å±•å¼€å‘½ä¸­èŠ‚ç‚¹è·¯å¾„
**And** æ¸…ç©ºèŠ‚ç‚¹æœç´¢åæ¢å¤å®Œæ•´èŠ‚ç‚¹æ ‘
**And** èŠ‚ç‚¹æœç´¢ä¸èµ„äº§æœç´¢å®Œå…¨ç‹¬ç«‹ï¼ˆæ— çŠ¶æ€å…±äº«ï¼‰

### AC6: æ‰¹é‡æ“ä½œå¢å¼º

**Given** èŠ‚ç‚¹è§†å›¾ä¸­é€‰ä¸­äº†å¤šä¸ªèµ„äº§
**When** æŸ¥çœ‹èµ„äº§é¢æ¿
**Then** åº”æ˜¾ç¤ºæ‰¹é‡åˆ é™¤æŒ‰é’®ï¼ˆä½¿ç”¨çº¢è‰²è­¦ç¤ºè‰²ï¼‰
**And** æ‰¹é‡åˆ é™¤æ“ä½œåº”è°ƒç”¨"è§£ç»‘"è€Œéç‰©ç†åˆ é™¤ï¼ˆä¸ Story 9.8 AC7 ä¿æŒä¸€è‡´ï¼‰
**And** æ“ä½œåæ˜¾ç¤º Undo Toast

---

## UI è®¾è®¡åŸå‹

> [!NOTE]
> ä»¥ä¸‹ UI åŸå‹ä¸é¡¹ç›®ç°æœ‰è®¾è®¡é£æ ¼ä¿æŒä¸€è‡´ï¼ˆæµ…è‰²ä¸»é¢˜ã€è“è‰²å¼ºè°ƒè‰²ã€å¡ç‰‡å¼å¸ƒå±€ã€åœ†è§’ UI å…ƒç´ ï¼‰ï¼Œè¯¦ç»†å±•ç¤ºå„ AC çš„è§†è§‰è§„æ ¼ã€‚

### å½“å‰é—®é¢˜ï¼šToolbar è®¾è®¡æˆªå›¾

å±•ç¤ºå½“å‰ Toolbar çš„å•è¡Œæ··åˆè®¾è®¡é—®é¢˜ï¼š

![å½“å‰Toolbarè®¾è®¡](../prototypes/story-9-9/current_toolbar_screenshot.png)

**å½“å‰é—®é¢˜åˆ†æï¼š**
| é—®é¢˜         | æè¿°                                   |
| ------------ | -------------------------------------- |
| æœç´¢åŠŸèƒ½é‡å  | å·¦ä¾§èŠ‚ç‚¹æœç´¢ vs é¡¶éƒ¨èµ„äº§æœç´¢ï¼Œç”¨æˆ·å›°æƒ‘ |
| ç­›é€‰æ§ä»¶æ··ä¹± | ç±»å‹ç­›é€‰ã€æ—¥æœŸèŒƒå›´ä¸æ“ä½œæŒ‰é’®å¹¶åˆ—       |
| è§†è§‰å±‚æ¬¡ä¸æ¸… | æ“ä½œç±»ã€ç­›é€‰ç±»ã€è§†å›¾æ§åˆ¶ç±»æ··åˆåœ¨å•è¡Œ   |

---

### åŸå‹ 1: æ–°æ—§è®¾è®¡å¯¹æ¯” (Before vs After)

å±•ç¤ºä»å•è¡Œæ··åˆ Toolbar åˆ°åŒè¡Œåˆ†å±‚è®¾è®¡çš„å˜åŒ–ï¼š

![æ–°æ—§è®¾è®¡å¯¹æ¯”](../prototypes/story-9-9/toolbar_before_after.png)

**è®¾è®¡å˜åŒ–è¦ç‚¹ï¼š**

| æ–¹é¢            | å½“å‰è®¾è®¡ (Before)           | æ–°è®¾è®¡ (After)         |
| --------------- | --------------------------- | ---------------------- |
| **Toolbarå†…å®¹** | æ“ä½œ+ç­›é€‰æ··åˆï¼ˆ10+æ§ä»¶ï¼‰    | ä»…æ“ä½œç±»ï¼ˆ6ä¸ªæ§ä»¶ï¼‰    |
| **æœç´¢ä½ç½®**    | Toolbarä¸­ï¼ˆä¸èŠ‚ç‚¹æœç´¢æ··æ·†ï¼‰ | ç‹¬ç«‹ç­›é€‰æ ï¼ˆä½ç½®æ¸…æ™°ï¼‰ |
| **ç­›é€‰æ§ä»¶**    | ä¸æ“ä½œæŒ‰é’®å¹¶åˆ—              | å•ç‹¬ä¸€è¡Œï¼Œç´§é‚»èµ„äº§åˆ—è¡¨ |
| **è§†è§‰å±‚æ¬¡**    | å•å±‚ï¼Œå¯†åº¦é«˜                | åŒå±‚ï¼Œå±‚æ¬¡åˆ†æ˜         |

**æ–°è®¾è®¡ä¼˜åŠ¿ï¼š**
- âœ… æœç´¢èŒƒå›´æ¸…æ™°
- âœ… æ“ä½œä¸ç­›é€‰åˆ†ç¦»
- âœ… è§†è§‰å±‚æ¬¡ä¼˜åŒ–

---

### åŸå‹ 2: å®Œæ•´å¸ƒå±€è§†å›¾ (Full Layout)

å±•ç¤ºåˆå¹¶åçš„èŠ‚ç‚¹è§†å›¾å®Œæ•´å¸ƒå±€ï¼ŒåŒ…å«æ‰€æœ‰æ–°å¢ç»„ä»¶ï¼š

![å®Œæ•´å¸ƒå±€](../prototypes/story-9-9/full_layout_mockup.png)

**æ•´ä½“å¸ƒå±€ç»“æ„ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            æ•°æ®èµ„æºåº“                                    âœ•   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       â”‚  ğŸ“¤ ä¸Šä¼  â–¾   ğŸ“ å›æ”¶ç«™  â”‚              âŠ â‰¡ ğŸ“Š  â˜°  â”‚
â”‚  èŠ‚ç‚¹(PBS+ä»»åŠ¡) â”‚æ–‡ä»¶å¤¹â”‚  [ä»…ä¿ç•™æ“ä½œç±»æŒ‰é’®]    â”‚                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”—èŠ‚ç‚¹    ğŸ“„èµ„äº§   â”‚  ğŸ” æœç´¢èµ„äº§... â”‚ ğŸ“èŒƒå›´â–¾ â”‚ ğŸ“‹ç±»å‹â–¾ â”‚ ğŸ“… æ—¥æœŸèŒƒå›´  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  [æ–°å¢ï¼šç‹¬ç«‹èµ„äº§ç­›é€‰æ ]                              â”‚
â”‚  ğŸ” [æœç´¢èŠ‚ç‚¹...]  âœ•â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åœ¨PBSå’Œä»»åŠ¡ä¸­æœç´¢   â”‚  ä¸­å¿ƒä¸»é¢˜ > XXå«æ˜Ÿ > å«æ˜Ÿæ€»ä½“ > ä»»åŠ¡è½¨é“è®¾è®¡         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¡ ğŸŸ  XXå«æ˜Ÿ         â”‚                                                      â”‚
â”‚    â–¡ ğŸŸ  å«æ˜Ÿæ€»ä½“     â”‚              [èµ„äº§ç½‘æ ¼/åˆ—è¡¨]                         â”‚
â”‚      â˜‘ âœ“ ä»»åŠ¡è½¨é“è®¾è®¡â”‚                                                      â”‚
â”‚         ...          â”‚                                                      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                                                      â”‚
â”‚  å·²é€‰ 3 ä¸ªèŠ‚ç‚¹ [æ¸…é™¤]â”‚                                                      â”‚
â”‚  å…± 156 ä¸ªæ•°æ®èµ„äº§   â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¦ä¾§é¢æ¿è§„æ ¼ï¼š**

| å…ƒç´     | è§„æ ¼                        |
| ------- | --------------------------- |
| å®½åº¦    | 220px                       |
| Tabåˆ‡æ¢ | `èŠ‚ç‚¹(PBS+ä»»åŠ¡)` / `æ–‡ä»¶å¤¹` |
| äºŒçº§Tab | `ğŸ”—èŠ‚ç‚¹` / `ğŸ“„èµ„äº§`           |
| æœç´¢æ¡†  | å¸¦æ¸…é™¤æŒ‰é’®ï¼Œä¸‹æ–¹å¸®åŠ©æ–‡å­—    |
| èŠ‚ç‚¹æ ‘  | checkboxå¤šé€‰ + ç±»å‹å›¾æ ‡     |

**å³ä¾§å†…å®¹åŒºè§„æ ¼ï¼š**

| è¡Œ         | å†…å®¹                    | é«˜åº¦   |
| ---------- | ----------------------- | ------ |
| Toolbar    | ä¸Šä¼ ã€å›æ”¶ç«™ã€è§†å›¾åˆ‡æ¢  | 56px   |
| ç­›é€‰æ      | æœç´¢ã€èŒƒå›´ã€ç±»å‹ã€æ—¥æœŸ  | 48px   |
| Breadcrumb | è·¯å¾„å¯¼èˆª + ç©ºåˆ†ç»„Toggle | 40px   |
| å†…å®¹åŒº     | èµ„äº§ç½‘æ ¼/åˆ—è¡¨           | flex-1 |

---

### åŸå‹ 3: æœç´¢èŒƒå›´é€‰æ‹©å™¨ (Scope Selector)

å±•ç¤ºæœç´¢èŒƒå›´ä¸‹æ‹‰èœå•çš„å±•å¼€çŠ¶æ€ï¼š

![æœç´¢èŒƒå›´é€‰æ‹©å™¨](../prototypes/story-9-9/scope_selector_dropdown.png)

**é€‰é¡¹è®¾è®¡ï¼š**

| é€‰é¡¹             | å›¾æ ‡ | æè¿°                       | ä½¿ç”¨åœºæ™¯       |
| ---------------- | ---- | -------------------------- | -------------- |
| **ğŸ“ å½“å‰èŠ‚ç‚¹**   | ğŸ“    | æœç´¢å½“å‰é€‰ä¸­èŠ‚ç‚¹çš„å…³è”èµ„äº§ | æŸ¥çœ‹èŠ‚ç‚¹äº¤ä»˜ç‰© |
| **ğŸŒ å…¨éƒ¨èµ„äº§**   | ğŸŒ    | æœç´¢æ•´ä¸ªå›¾è°±çš„æ‰€æœ‰èµ„äº§     | è·¨èŠ‚ç‚¹æŸ¥æ‰¾     |
| **ğŸ“ æœªå…³è”èµ„äº§** | ğŸ“    | æœç´¢æœªä¸ä»»ä½•èŠ‚ç‚¹å…³è”çš„èµ„äº§ | æ•°æ®æ•´ç†       |

**äº¤äº’è§„æ ¼ï¼š**
- é»˜è®¤é€‰ä¸­ï¼š`å½“å‰èŠ‚ç‚¹`
- åˆ‡æ¢åç«‹å³åˆ·æ–°æœç´¢ç»“æœ
- é€‰ä¸­é¡¹æ˜¾ç¤ºè“è‰²èƒŒæ™¯+å‹¾é€‰æ ‡è®°
- æ¯ä¸ªé€‰é¡¹åŒ…å«ä¸»æ ‡é¢˜+æè¿°å‰¯æ–‡æœ¬

---

### åŸå‹ 4: ç­›é€‰çŠ¶æ€è¡Œä¸ºè§„åˆ™ (Filter State Behavior)

å±•ç¤ºå››ç§åœºæ™¯ä¸‹ç­›é€‰çŠ¶æ€çš„è¡Œä¸ºï¼š

![ç­›é€‰çŠ¶æ€è¡Œä¸º](../prototypes/story-9-9/filter_state_behavior.png)

**è¡Œä¸ºè§„åˆ™è¯¦è§£ï¼š**

#### åœºæ™¯ 1: åˆ‡æ¢èŠ‚ç‚¹ (âœ… ä¿æŒ)
```
èŠ‚ç‚¹ A â†’ èŠ‚ç‚¹ B
ç­›é€‰æ¡ä»¶ï¼šä¿æŒä¸å˜
ç»“æœï¼šç­›é€‰åº”ç”¨åˆ°æ–°èŠ‚ç‚¹
```

#### åœºæ™¯ 2: åˆ‡æ¢è§†è§’ (âŒ æ¸…ç©º)
```
èŠ‚ç‚¹è§†å›¾ â†’ æ–‡ä»¶å¤¹è§†å›¾
ç­›é€‰æ¡ä»¶ï¼šæ¸…ç©º
æç¤ºï¼šToast "ç­›é€‰å·²é‡ç½®"
```

#### åœºæ™¯ 3: å…³é—­/é‡æ–°æ‰“å¼€ (âœ… ä¼šè¯å†…ä¿æŒ)
```
Drawer å…³é—­ â†’ é‡æ–°æ‰“å¼€
ç­›é€‰æ¡ä»¶ï¼šä¿æŒï¼ˆä¼šè¯å†…ï¼‰
```

#### åœºæ™¯ 4: åˆ·æ–°é¡µé¢ (âš ï¸ æ¸…ç©º)
```
æµè§ˆå™¨åˆ·æ–°
ç­›é€‰æ¡ä»¶ï¼šæ¸…ç©ºï¼ˆä¸æŒä¹…åŒ–ï¼‰
```

---

### åŸå‹ 5: åˆç‰ˆè®¾è®¡è‰å›¾

æ—©æœŸå¤´è„‘é£æš´é˜¶æ®µçš„æ¦‚å¿µè®¾è®¡ï¼š

![åˆç‰ˆè®¾è®¡](../prototypes/story-9-9/toolbar_redesign_v2.png)

---

### UI ç»„ä»¶æ–‡ä»¶ç»“æ„

```
apps/web/features/data-library/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ asset-filter/                 # [NEW] èµ„äº§ç­›é€‰æ æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ AssetFilterBar.tsx        # ç­›é€‰æ ä¸»ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ScopeSelector.tsx         # èŒƒå›´é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ TypeFilter.tsx            # ç±»å‹ç­›é€‰
â”‚   â”‚   â”œâ”€â”€ DateRangeFilter.tsx       # æ—¥æœŸèŒƒå›´
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ data-library-drawer/
â”‚   â”‚   â”œâ”€â”€ DataLibraryDrawerToolbar.tsx  # [MODIFY] ç²¾ç®€ä¸ºæ“ä½œç±»
â”‚   â”‚   â”œâ”€â”€ DataLibraryDrawerContent.tsx  # [MODIFY] é›†æˆç­›é€‰æ 
â”‚   â”‚   â””â”€â”€ DataLibraryDrawerView.tsx     # [MODIFY] å¸ƒå±€è°ƒæ•´
â”‚   â””â”€â”€ node-tree/
â”‚       â””â”€â”€ NodeTreeView.tsx              # [MODIFY] æ·»åŠ æœç´¢å¸®åŠ©æ–‡å­—
â””â”€â”€ hooks/
    â””â”€â”€ useAssetFilterState.ts            # [NEW] ç­›é€‰çŠ¶æ€ Hook
```

---

### æ ·å¼è§„èŒƒ

#### ç­›é€‰æ æ ·å¼

| å±æ€§   | äº®è‰²æ¨¡å¼            | æš—è‰²æ¨¡å¼            |
| ------ | ------------------- | ------------------- |
| èƒŒæ™¯è‰² | `#FFFFFF`           | `#1F2937`           |
| è¾¹æ¡†   | `1px solid #E5E7EB` | `1px solid #374151` |
| åœ†è§’   | `8px`               | `8px`               |
| é«˜åº¦   | `48px`              | `48px`              |
| å†…è¾¹è· | `12px 16px`         | `12px 16px`         |

#### é¢œè‰²è§„èŒƒ

| ç”¨é€”     | äº®è‰²æ¨¡å¼  | æš—è‰²æ¨¡å¼  |
| -------- | --------- | --------- |
| ä¸»æŒ‰é’®   | `#3B82F6` | `#3B82F6` |
| å±é™©æŒ‰é’® | `#EF4444` | `#EF4444` |
| é€‰ä¸­çŠ¶æ€ | `#EFF6FF` | `#1E3A5F` |
| è¾¹æ¡†     | `#E5E7EB` | `#374151` |
| æ–‡å­—     | `#111827` | `#F9FAFB` |

#### æ§ä»¶è§„æ ¼

**æœç´¢è¾“å…¥æ¡†ï¼š**
| å±æ€§        | å€¼                 |
| ----------- | ------------------ |
| é«˜åº¦        | `36px`             |
| å®½åº¦        | `flex-1`ï¼ˆè‡ªé€‚åº”ï¼‰ |
| åœ†è§’        | `8px`              |
| Placeholder | `æœç´¢èµ„äº§...`      |
| å›¾æ ‡        | ğŸ” å·¦ä¾§å†…ç½®         |

**èŒƒå›´é€‰æ‹©å™¨ï¼š**
| å±æ€§     | å€¼                 |
| -------- | ------------------ |
| ç±»å‹     | Dropdown Select    |
| å®½åº¦     | `auto`ï¼ˆå†…å®¹é€‚åº”ï¼‰ |
| é»˜è®¤é€‰é¡¹ | `å½“å‰èŠ‚ç‚¹`         |
| é€‰é¡¹æ ·å¼ | å¸¦å›¾æ ‡ï¼ˆğŸ“/ğŸŒ/ğŸ“ï¼‰    |

## Tasks / Subtasks

- [x] Task 1: åˆ›å»º AssetFilterBar ç»„ä»¶ (AC: #2, #3)
  - [x] 1.1 åˆ›å»º `components/asset-filter/` ç›®å½•ç»“æ„
  - [x] 1.2 å®ç° `AssetFilterBar.tsx` ä¸»ç»„ä»¶ï¼ˆæœç´¢è¾“å…¥ + ç­›é€‰ä¸‹æ‹‰ï¼‰
  - [x] 1.3 å®ç° `ScopeSelector.tsx` æœç´¢èŒƒå›´é€‰æ‹©å™¨ï¼ˆä¸‰é€‰é¡¹ä¸‹æ‹‰ï¼‰
  - [x] 1.4 å®ç° `TypeFilter.tsx` ç±»å‹ç­›é€‰å™¨ï¼ˆå¤ç”¨ç°æœ‰ DataFormat æšä¸¾ï¼‰
  - [x] 1.5 å®ç° `DateRangeFilter.tsx` æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨
  - [x] 1.6 æ·»åŠ  300ms debounce é€»è¾‘åˆ°æœç´¢è¾“å…¥
  - [x] 1.7 å®ç°ã€Œå·²åº”ç”¨ N ä¸ªç­›é€‰ã€å¾½ç« 

- [x] Task 2: é‡æ„ DataLibraryDrawerToolbar (AC: #1)
  - [x] 2.1 ç§»é™¤ Toolbar ä¸­çš„æœç´¢è¾“å…¥æ¡†
  - [x] 2.2 ç§»é™¤ Toolbar ä¸­çš„ç±»å‹ç­›é€‰ä¸‹æ‹‰
  - [x] 2.3 ç§»é™¤ Toolbar ä¸­çš„æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨
  - [x] 2.4 ä¿ç•™æ“ä½œç±»æ§ä»¶ï¼šä¸Šä¼ æŒ‰é’®ã€æ‰¹é‡åˆ é™¤ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰ã€å›æ”¶ç«™
  - [x] 2.5 ä¿ç•™è§†å›¾æ§åˆ¶ç±»æ§ä»¶ï¼šç½‘æ ¼/åˆ—è¡¨åˆ‡æ¢ã€å·¦ä¾§é¢æ¿ Toggle
  - [x] 2.6 è°ƒæ•´ Toolbar å¸ƒå±€ï¼ˆé«˜åº¦ â‰¤ 56pxï¼‰

- [x] Task 3: ç­›é€‰çŠ¶æ€ç®¡ç†é‡æ„ (AC: #4)
  - [x] 3.1 åˆ›å»º `useAssetFilterState` Hookï¼ˆç®¡ç† assetSearchQueryã€searchScopeã€formatFilterã€createdAfterã€createdBeforeï¼‰
  - [x] 3.2 å®ç°ç­›é€‰çŠ¶æ€åœ¨åˆ‡æ¢èŠ‚ç‚¹æ—¶ä¿æŒ
  - [x] 3.3 å®ç°ç­›é€‰çŠ¶æ€åœ¨åˆ‡æ¢è§†è§’æ—¶æ¸…ç©º + Toast æç¤º
  - [x] 3.4 å®ç°ç­›é€‰çŠ¶æ€ä¼šè¯å†…ä¿æŒï¼ˆDrawer å…³é—­/é‡å¼€ï¼‰
  - [x] 3.5 æ›´æ–° `DataLibraryDrawerPanel.tsx` é›†æˆæ–°ç­›é€‰æ 

- [x] Task 4: æ”¯æŒã€Œæœªå…³è”èµ„äº§ã€èŒƒå›´ï¼ˆAPI + Typesï¼‰(AC: #3)
  - [x] 4.1 æ‰©å±• `@cdm/types` çš„ `DataAssetQueryDto`ï¼šæ–°å¢ `linkStatus?: 'unlinked'`
  - [x] 4.2 åç«¯ `GET /api/data-assets` æ”¯æŒ `linkStatus=unlinked`
    - åœ¨ `data-asset.controller.ts` çš„ `list` æ–¹æ³•æ·»åŠ  `linkStatus` æŸ¥è¯¢å‚æ•°
    - åœ¨ `data-asset.repository.ts` æ·»åŠ  WHERE æ¡ä»¶ï¼š`nodeLinks: { none: {} }`
    - ç¡®ä¿åˆ†é¡µå’Œå…¶ä»–ç­›é€‰æ¡ä»¶æ­£å¸¸å·¥ä½œ
  - [x] 4.3 å‰ç«¯ `fetchDataAssets` / `useDataAssets` æ”¯æŒé€ä¼  `linkStatus`
  - [x] 4.4 æ·»åŠ å•å…ƒæµ‹è¯•éªŒè¯ unlinked ç­›é€‰æ­£ç¡®æ€§

- [x] Task 5: é›†æˆèµ„äº§ç­›é€‰æ åˆ° Drawer + æœç´¢è¿ç§» (AC: #2, #3, #5)
  - [x] 5.1 åœ¨ `DataLibraryDrawerPanel.tsx` å¸ƒå±€ä¸­æ’å…¥ `AssetFilterBar`
  - [x] 5.2 å°†ç­›é€‰çŠ¶æ€ä¼ é€’ç»™ `useDataAssets` / `useSelectedNodesAssets` / `useAssetLinks`ï¼Œå¹¶æŒ‰ `searchScope` åˆ‡æ¢æ•°æ®æ¥æºï¼ˆAC3ï¼‰
  - [x] 5.3 ä¿®æ”¹å·¦ä¾§èŠ‚ç‚¹æœç´¢ï¼šä»…ä¿ç•™èŠ‚ç‚¹æœç´¢è¾“å…¥æ¡†ï¼ˆç§»é™¤/ç¦ç”¨å·¦ä¾§èµ„äº§æœç´¢å…¥å£ï¼‰ï¼Œå¹¶æ˜¾ç¤ºå¸®åŠ©æ–‡å­—ã€Œåœ¨ PBS å’Œä»»åŠ¡èŠ‚ç‚¹ä¸­æœç´¢ã€
  - [x] 5.4 ç¡®ä¿èŠ‚ç‚¹æœç´¢ä¸èµ„äº§æœç´¢çŠ¶æ€ç‹¬ç«‹
  - [x] 5.5 **[DualSearch è¿ç§»]** ç§»é™¤ `DualSearch.tsx` ä¸­çš„ `searchMode='asset'` åˆ†æ”¯å’Œåˆ‡æ¢ UI
  - [x] 5.6 **[DualSearch è¿ç§»]** å°† `DualSearch` é‡å‘½åæˆ–ç®€åŒ–ä¸º `NodeSearch`ï¼ˆä»…ä¿ç•™èŠ‚ç‚¹æœç´¢åŠŸèƒ½ï¼‰
  - [x] 5.7 **[DualSearch è¿ç§»]** ä» `DataLibraryDrawer.tsx` ç§»é™¤ `searchMode` çŠ¶æ€åŠç›¸å…³é€»è¾‘ï¼ˆlines 74-166ï¼‰
  - [x] 5.8 **[DualSearch è¿ç§»]** æ›´æ–° `DataLibraryDrawerContent.tsx` ç§»é™¤å¯¹ `searchMode` çš„ä¾èµ–

- [x] Task 6: æ‰¹é‡æ“ä½œå¢å¼º (AC: #6)
  - [x] 6.1 æ›´æ–°æ‰¹é‡åˆ é™¤æŒ‰é’®æ ·å¼ï¼ˆçº¢è‰²è­¦ç¤ºè‰²ï¼‰
  - [x] 6.2 ç¡®ä¿æ‰¹é‡åˆ é™¤è°ƒç”¨è§£ç»‘ APIï¼ˆå¤ç”¨ Story 9.8 çš„ `useNodeAssetUnlink`ï¼‰
  - [x] 6.3 æ·»åŠ  Undo Toast

- [x] Task 7: å•å…ƒæµ‹è¯•
  - [x] 7.1 `AssetFilterBar.test.tsx` - ç­›é€‰æ ç»„ä»¶æµ‹è¯•
  - [x] 7.2 `ScopeSelector.test.tsx` - èŒƒå›´é€‰æ‹©å™¨æµ‹è¯•
  - [x] 7.3 `useAssetFilterState.test.ts` - ç­›é€‰çŠ¶æ€ Hook æµ‹è¯•
  - [x] 7.4 **[æ›´æ–°ç°æœ‰æµ‹è¯•]** `DataLibraryDrawer.test.tsx` - ç§»é™¤å¯¹ toolbar æœç´¢æ¡†/æ—¥æœŸé€‰æ‹©å™¨çš„æ–­è¨€
  - [x] 7.5 **[æ›´æ–°ç°æœ‰æµ‹è¯•]** `DualSearch.test.tsx` - æ›´æ–°ä¸ºä»…æµ‹è¯•èŠ‚ç‚¹æœç´¢ï¼ˆç§»é™¤ asset mode æµ‹è¯•ï¼‰

- [x] Task 8: E2E æµ‹è¯•
  - [x] 8.1 `toolbar-redesign.spec.ts` - Toolbar æ“ä½œæŒ‰é’®æµ‹è¯•
  - [x] 8.2 èµ„äº§ç­›é€‰æ åŠŸèƒ½æµ‹è¯•
  - [x] 8.3 è§†è§’åˆ‡æ¢ç­›é€‰é‡ç½®æµ‹è¯•
  - [x] 8.4 **[æ›´æ–°ç°æœ‰æµ‹è¯•]** `data-library.spec.ts` - æ›´æ–°æœç´¢/ç­›é€‰ç›¸å…³ç”¨ä¾‹ï¼ˆlines 139-163ï¼‰

- [x] Task 9: Review Follow-ups (AI) - Code Review 2026-01-14 (Resolved 2026-01-14)
  - [x] 9.1 [HIGH] E2E AC4 Toast éªŒè¯ç¼ºå¤± - è¡¥å……éªŒè¯ã€Œç­›é€‰å·²é‡ç½®ã€Toast æ˜¾ç¤º
  - [x] 9.2 [MEDIUM] ScopeSelector é”®ç›˜æ— éšœç¢ - å¢åŠ  Arrow/Enter/Escape é”®ç›˜å¯¼èˆª
  - [x] 9.3 [MEDIUM] scopeDisabled é€»è¾‘æœªå¯ç”¨ - èŠ‚ç‚¹æœªé€‰ä¸­æ—¶ç¦ç”¨ã€Œå½“å‰èŠ‚ç‚¹ã€scope
  - [x] 9.4 [MEDIUM] DualSearch å…¼å®¹å¯¼å‡ºè¯¯å¯¼ - `NodeSearch.tsx` ä¿ç•™ `DualSearch` åˆ«åå¹¶æ·»åŠ  @deprecated
  - [x] 9.5 [MEDIUM] FilterBadge ARIA ç¼ºå¤± - è¡¥å…… `role="status"` + `aria-live`
  - [x] 9.6 [LOW] æ–‡ä»¶æœªé‡å‘½å - `DualSearch.tsx` å·²é‡å‘½åä¸º `NodeSearch.tsx`ï¼ˆTask 5.6ï¼‰
  - [x] 9.7 [LOW] æµ‹è¯•ç¡¬ç¼–ç å­—ç¬¦ä¸² - ä» `SCOPE_OPTIONS` å¸¸é‡å¯¼å…¥/ç”Ÿæˆæ–­è¨€

## Dev Notes

### æŠ€æœ¯è§„æ ¼è¯´æ˜

> [!IMPORTANT]
> æœ¬ Story åŸºäº Story 9.8ï¼ˆèŠ‚ç‚¹è§†å›¾åˆå¹¶ï¼‰çš„å®ç°ï¼Œå¤ç”¨å…¶ç»„ä»¶å’Œ APIã€‚

### æ¶æ„çº¦æŸ

- **æ•°æ®æ¨¡å‹**ï¼šä½¿ç”¨ç°æœ‰ `DataAsset` å’Œ `NodeDataLink` æ¨¡å‹
- **çŠ¶æ€ç®¡ç†**ï¼šç­›é€‰çŠ¶æ€ä¸èŠ‚ç‚¹é€‰æ‹©çŠ¶æ€åˆ†ç¦»ç®¡ç†
- **ç»„ä»¶å¤ç”¨**ï¼šå¤ç”¨ Story 9.8 çš„ `useNodeAssetUnlink`ã€`GroupedAssetList` ç­‰ç»„ä»¶

---

### ğŸš§ å·¥ç¨‹è§„èŒƒæŠ¤æ  (Engineering Guardrails)

> [!CAUTION]
> ä»¥ä¸‹è§„åˆ™æ˜¯å¼€å‘è€…**å¿…é¡»éµå®ˆ**çš„ç¡¬æ€§çº¦æŸï¼Œè¿åå°†å¯¼è‡´ä»£ç å®¡æŸ¥å¤±è´¥ã€‚

#### ğŸš¨ åæ¨¡å¼è­¦å‘Š (Anti-Patterns)

| åæ¨¡å¼                | ç¦æ­¢ç¤ºä¾‹                                   | æ­£ç¡®åšæ³•                      | åŸå›                                    |
| --------------------- | ------------------------------------------ | ----------------------------- | -------------------------------------- |
| **ç›´æ¥ fetch è°ƒç”¨**   | ç»„ä»¶å†… `fetch('/api/data-assets')`         | ä½¿ç”¨ `useDataAssets` Hook     | ç¬¦åˆ Hook-First æ¨¡å¼ï¼Œé€»è¾‘å¯å¤ç”¨å¯æµ‹è¯• |
| **åŒçŠ¶æ€å†™å…¥**        | `setState(x); api.update(x)`               | ä»…ä¿®æ”¹çŠ¶æ€ï¼Œç”± Hook å¤„ç†åŒæ­¥  | é¿å…æ•°æ®ä¸ä¸€è‡´å’Œç«æ€æ¡ä»¶               |
| **localStorage æ»¥ç”¨** | ç­›é€‰çŠ¶æ€å­˜ localStorage                    | React Stateï¼ˆä¼šè¯çº§ï¼‰         | ç­›é€‰çŠ¶æ€æ— éœ€æŒä¹…åŒ–ï¼Œåˆ·æ–°é‡ç½®æ˜¯é¢„æœŸè¡Œä¸º |
| **ç¡¬ç¼–ç å­—ç¬¦ä¸²**      | `'current-node'` æ•£è½ä»£ç                   | ä½¿ç”¨ `SearchScope` æšä¸¾       | ç±»å‹å®‰å…¨ï¼ŒIDE æç¤ºï¼Œé‡æ„å‹å¥½           |
| **å†…è”æ ·å¼**          | `style={{ height: 48 }}`                   | TailwindCSS `h-12`            | éµå¾ª Utility-First ç­–ç•¥                |
| **è·¨åŒ…ç›¸å¯¹å¯¼å…¥**      | `import { X } from '../../../packages/ui'` | `import { X } from '@cdm/ui'` | ä½¿ç”¨ Workspace åˆ«å                    |

#### âœ… å¿…é¡»éµå¾ªçš„æ¨¡å¼ (Mandatory Patterns)

##### 1. ç±»å‹å®šä¹‰æ¥æº
```typescript
// âŒ ç¦æ­¢ï¼šåœ¨ç»„ä»¶/Hook ä¸­å®šä¹‰ä¸šåŠ¡ç±»å‹
interface AssetFilterState { ... }

// âœ… æ­£ç¡®ï¼šä» @cdm/types å¯¼å…¥æˆ–æ‰©å±•
import { DataAssetFormat } from '@cdm/types';

// å¦‚éœ€æ‰©å±•ï¼Œåœ¨ packages/types ä¸­å®šä¹‰
export interface AssetFilterState {
  assetSearchQuery: string;
  searchScope: SearchScope;
  formatFilter: DataAssetFormat | '';
  // ...
}
```

##### 2. Hook é€»è¾‘å°è£…
```typescript
// âŒ ç¦æ­¢ï¼šç»„ä»¶å†…ç›´æ¥ç®¡ç†ç­›é€‰é€»è¾‘
function AssetFilterBar() {
  const [query, setQuery] = useState('');
  const [scope, setScope] = useState<SearchScope>('current-node');
  // ... å¤§é‡é€»è¾‘
}

// âœ… æ­£ç¡®ï¼šæŠ½ç¦»è‡³ä¸“ç”¨ Hook
function AssetFilterBar() {
  const {
    filterState,
    setAssetSearchQuery,
    setSearchScope,
    clearAllFilters,
    activeFilterCount,
  } = useAssetFilterState();
  // ç»„ä»¶ä»…è´Ÿè´£ UI æ¸²æŸ“
}
```

##### 3. ç»„ä»¶å¯¼å…¥æ¥æº
```typescript
// âŒ ç¦æ­¢ï¼šä½¿ç”¨åŸç”Ÿ HTML æˆ–è‡ªå®šä¹‰æ ·å¼
<button className="my-btn">ä¸Šä¼ </button>
<input className="search-input" />

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ @cdm/ui ç»„ä»¶åº“
import { Button, Input, Select } from '@cdm/ui';
<Button variant="primary">ä¸Šä¼ </Button>
<Input placeholder="æœç´¢èµ„äº§..." icon={<SearchIcon />} />
```

##### 4. debounce å®ç°
```typescript
// âœ… æ¨èï¼šå¤ç”¨ä»“åº“å·²æœ‰çš„ use-debounceï¼ˆapps/web å·²ä¾èµ–ä¸”å·²æœ‰ä½¿ç”¨æ¡ˆä¾‹ï¼‰
import { useDebounce } from 'use-debounce';

const [debouncedQuery] = useDebounce(query, 300);

// âœ… ä¹Ÿå¯ï¼šæ²¿ç”¨å½“å‰ Data Library å·²å­˜åœ¨çš„ setTimeout debounce å†™æ³•ï¼ˆä¿æŒä¸€è‡´å³å¯ï¼‰
useEffect(() => {
  const timer = setTimeout(() => onSearch(query), 300);
  return () => clearTimeout(timer);
}, [query]);
```

##### 5. äº‹ä»¶å¤„ç†å‘½å
```typescript
// âŒ ç¦æ­¢ï¼šæ¨¡ç³Šå‘½å
const handleChange = () => { ... };
const onClick = () => { ... };

// âœ… æ­£ç¡®ï¼šæ¸…æ™°è¯­ä¹‰å‘½å
const handleSearchQueryChange = (query: string) => { ... };
const handleScopeSelect = (scope: SearchScope) => { ... };
const handleClearFilters = () => { ... };
```

#### âš ï¸ è¾¹ç¼˜æƒ…å†µå¤„ç† (Edge Cases)

| åœºæ™¯                     | å¤„ç†æ–¹å¼                                    | æµ‹è¯•ç”¨ä¾‹ |
| ------------------------ | ------------------------------------------- | -------- |
| ç­›é€‰ç»“æœä¸ºç©º             | æ˜¾ç¤ºç©ºæ€ç»„ä»¶ + æ¸…é™¤ç­›é€‰æŒ‰é’®                 | IT-2.5   |
| æœç´¢è¾“å…¥ç‰¹æ®Šå­—ç¬¦         | ä½¿ç”¨ `escapeRegex()` å¤„ç†ï¼ˆå¤ç”¨ Story 9.8ï¼‰ | UT-1.7   |
| èŠ‚ç‚¹æœªé€‰ä¸­æ—¶åˆ‡æ¢èŒƒå›´     | `å½“å‰èŠ‚ç‚¹` ç¦ç”¨æˆ–æ˜¾ç¤ºæç¤º                   | IT-4.4   |
| æ–‡ä»¶å¤¹è§†å›¾æ— èŒƒå›´é€‰æ‹©å™¨   | éšè— ScopeSelector æˆ–é”å®šä¸º `å½“å‰æ–‡ä»¶å¤¹`    | IT-4.5   |
| å¿«é€Ÿåˆ‡æ¢è§†è§’ï¼ˆè¿ç»­ç‚¹å‡»ï¼‰ | debounce è§†è§’åˆ‡æ¢ï¼Œé˜²æ­¢çŠ¶æ€é—ªçƒ             | -        |
| ç½‘ç»œè¯·æ±‚å¤±è´¥             | æ˜¾ç¤ºé”™è¯¯ Toastï¼Œä¿æŒç­›é€‰çŠ¶æ€ä¾›é‡è¯•          | -        |

#### âš¡ æ€§èƒ½è§„åˆ™ (Performance Rules)

| è§„åˆ™              | è¦æ±‚                                                                              | éªŒè¯æ–¹å¼     |
| ----------------- | --------------------------------------------------------------------------------- | ------------ |
| **ç­›é€‰å“åº”æ—¶é—´**  | P95 < 200ms                                                                       | E2E æ€§èƒ½æ–­è¨€ |
| **æœç´¢ debounce** | 300ms                                                                             | UT-1.2       |
| **åˆå§‹æ¸²æŸ“**      | ç­›é€‰æ  FCP < 50ms                                                                 | Lighthouse   |
| **ç»„ä»¶æ‹†åˆ†**      | æ¯ä¸ªç­›é€‰æ§ä»¶ç‹¬ç«‹ç»„ä»¶ï¼ˆScopeSelector/TypeFilter/DateRangeFilterï¼‰                  | ä»£ç å®¡æŸ¥     |
| **ä¾èµ–æ§åˆ¶**      | æ—¥æœŸèŒƒå›´ä½¿ç”¨åŸç”Ÿ `input[type="date"]`ï¼ˆä¸ç°æœ‰å®ç°ä¸€è‡´ï¼Œä¸å¼•å…¥æ–° DatePicker ä¾èµ–ï¼‰ | ä»£ç å®¡æŸ¥     |

#### ğŸ”’ çŠ¶æ€éš”ç¦»è§„åˆ™ (State Isolation)

```typescript
// çŠ¶æ€åˆ†å±‚è®¾è®¡
interface DataLibraryDrawerState {
  // === ç»„ç»‡çŠ¶æ€ï¼ˆæ¥è‡ª Story 9.8ï¼‰===
  activeNodeId: string | null;        // å½“å‰æ¿€æ´»èŠ‚ç‚¹ï¼ˆbreadcrumbï¼‰
  selectedNodeIds: Set<string>;       // å¤šé€‰èŠ‚ç‚¹é›†åˆï¼ˆå¹¶é›†æŸ¥è¯¢ï¼‰
  nodeExpandedIds: Set<string>;       // èŠ‚ç‚¹æ ‘å±•å¼€çŠ¶æ€
  nodeSearchQuery: string;            // ğŸ”— å·¦ä¾§èŠ‚ç‚¹æœç´¢ï¼ˆç‹¬ç«‹ï¼ï¼‰

  // === ç­›é€‰çŠ¶æ€ï¼ˆæœ¬ Story æ–°å¢ï¼‰===
  assetSearchQuery: string;           // ğŸ”— å³ä¾§èµ„äº§æœç´¢ï¼ˆç‹¬ç«‹ï¼ï¼‰
  searchScope: SearchScope;           // æœç´¢èŒƒå›´
  formatFilter: DataAssetFormat | ''; // ç±»å‹ç­›é€‰
  createdAfter: string;               // æ—¥æœŸèŒƒå›´èµ·
  createdBefore: string;              // æ—¥æœŸèŒƒå›´æ­¢
}

// ğŸš¨ å…³é”®éš”ç¦»ç‚¹
// nodeSearchQuery ä¸ assetSearchQuery å¿…é¡»å®Œå…¨ç‹¬ç«‹
// ä¿®æ”¹ä¸€ä¸ªä¸å¾—å½±å“å¦ä¸€ä¸ª
```

#### ğŸ“ æ–‡ä»¶ç»„ç»‡è§„åˆ™ (File Organization)

```
apps/web/features/data-library/components/asset-filter/
â”œâ”€â”€ AssetFilterBar.tsx        # ä¸»ç»„ä»¶ï¼ˆ< 150 è¡Œï¼‰
â”œâ”€â”€ ScopeSelector.tsx         # èŒƒå›´é€‰æ‹©å™¨ï¼ˆ< 100 è¡Œï¼‰
â”œâ”€â”€ TypeFilter.tsx            # ç±»å‹ç­›é€‰ï¼ˆ< 80 è¡Œï¼‰
â”œâ”€â”€ DateRangeFilter.tsx       # æ—¥æœŸèŒƒå›´ï¼ˆ< 100 è¡Œï¼‰
â”œâ”€â”€ FilterBadge.tsx           # ç­›é€‰å¾½ç« ï¼ˆ< 50 è¡Œï¼‰
â”œâ”€â”€ index.ts                  # ç»Ÿä¸€å¯¼å‡º
â””â”€â”€ __tests__/
    â”œâ”€â”€ AssetFilterBar.test.tsx
    â”œâ”€â”€ ScopeSelector.test.tsx
    â””â”€â”€ ...
```

**æ–‡ä»¶å¤§å°é™åˆ¶**ï¼š
- ç»„ä»¶æ–‡ä»¶ï¼š< 200 è¡Œï¼ˆè¶…è¿‡éœ€æ‹†åˆ†ï¼‰
- Hook æ–‡ä»¶ï¼š< 150 è¡Œ
- æµ‹è¯•æ–‡ä»¶ï¼šæ— é™åˆ¶ï¼Œä½†å•ä¸ªæµ‹è¯• < 30 è¡Œ

#### ğŸ§ª æµ‹è¯•è§„åˆ™ (Testing Rules)

```typescript
// âŒ ç¦æ­¢ï¼šæµ‹è¯•å®ç°ç»†èŠ‚
expect(component.state.query).toBe('test');

// âœ… æ­£ç¡®ï¼šæµ‹è¯•ç”¨æˆ·å¯è§è¡Œä¸º
expect(screen.getByPlaceholderText('æœç´¢èµ„äº§...')).toHaveValue('test');
expect(screen.getByText('å·²åº”ç”¨ 2 ä¸ªç­›é€‰')).toBeInTheDocument();

// âŒ ç¦æ­¢ï¼šMock è¿‡å¤šå†…éƒ¨æ¨¡å—
import { vi } from 'vitest';
vi.mock('../hooks/useAssetFilterState');
vi.mock('../components/ScopeSelector');

// âœ… æ­£ç¡®ï¼šåª Mock å¤–éƒ¨ä¾èµ–ï¼ˆAPI/Routerï¼‰
vi.mock('@/lib/api');
```

---

### API Contracts

- **[EXISTING]** `GET /api/data-assets` - æ”¯æŒ `search` / `format` / `folderId` / `createdAfter` / `createdBefore` / åˆ†é¡µ
- **[NEW]** `GET /api/data-assets?linkStatus=unlinked` - ä»…è¿”å›æœªä¸ä»»ä½•èŠ‚ç‚¹å…³è”çš„èµ„äº§ï¼ˆ`NodeDataLink`=0ï¼‰ï¼Œå“åº”ä»ä¸º `DataAssetListResponse`
- **[EXISTING]** `POST /api/data-assets/links:detailByNodes` - æ‰¹é‡èŠ‚ç‚¹èµ„äº§è¯¦æƒ…ï¼ˆStory 9.8ï¼‰
- **[EXISTING]** `POST /api/data-assets/links:destroyByNodes` - æ‰¹é‡è§£ç»‘ï¼ˆStory 9.8ï¼‰

#### linkStatus API è¯¦ç»†è§„æ ¼

```typescript
// packages/types/src/data-library-types.ts
export interface DataAssetQueryDto {
  graphId: string;
  search?: string;
  format?: DataAssetFormat;
  folderId?: string;
  createdAfter?: string;
  createdBefore?: string;
  linkStatus?: 'unlinked';  // [NEW] ä»…è¿”å›æ—  NodeDataLink çš„èµ„äº§
  page?: number;
  pageSize?: number;
}

// åç«¯å®ç°è¦ç‚¹ (data-asset.service.ts)
// å½“ linkStatus === 'unlinked' æ—¶ï¼š
// WHERE: { graphId, ..., nodeLinks: { none: {} } }
// æˆ–ä½¿ç”¨ _count è¿‡æ»¤ï¼šhaving _count.nodeLinks = 0
```

### å…³é”®æ”¹åŠ¨è½ç‚¹

| æ–‡ä»¶                                                                                         | ç±»å‹     | æè¿°                                         |
| -------------------------------------------------------------------------------------------- | -------- | -------------------------------------------- |
| `apps/web/features/data-library/components/asset-filter/AssetFilterBar.tsx`                  | [NEW]    | èµ„äº§ç­›é€‰æ ä¸»ç»„ä»¶                             |
| `apps/web/features/data-library/components/asset-filter/ScopeSelector.tsx`                   | [NEW]    | æœç´¢èŒƒå›´é€‰æ‹©å™¨                               |
| `apps/web/features/data-library/components/asset-filter/TypeFilter.tsx`                      | [NEW]    | ç±»å‹ç­›é€‰å™¨                                   |
| `apps/web/features/data-library/components/asset-filter/DateRangeFilter.tsx`                 | [NEW]    | æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨                               |
| `apps/web/features/data-library/components/asset-filter/index.ts`                            | [NEW]    | å¯¼å‡ºå…¥å£                                     |
| `apps/web/features/data-library/hooks/useAssetFilterState.ts`                                | [NEW]    | ç­›é€‰çŠ¶æ€ç®¡ç† Hook                            |
| `apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerToolbar.tsx` | [MODIFY] | ç§»é™¤ç­›é€‰æ§ä»¶ï¼Œç²¾ç®€ä¸ºæ“ä½œç±»                   |
| `apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerContent.tsx` | [MODIFY] | é›†æˆ AssetFilterBar                          |
| `apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerView.tsx`    | [MODIFY] | å¸ƒå±€è°ƒæ•´                                     |
| `apps/web/features/data-library/components/node-tree/NodeTreeView.tsx`                       | [MODIFY] | æ·»åŠ æœç´¢å¸®åŠ©æ–‡å­—                             |
| `apps/web/features/data-library/components/node-tree/DualSearch.tsx`                         | [MODIFY] | **[è¿ç§»]** ç§»é™¤ asset æ¨¡å¼ï¼Œç®€åŒ–ä¸ºä»…èŠ‚ç‚¹æœç´¢ |
| `apps/web/features/data-library/components/DataLibraryDrawer.tsx`                            | [MODIFY] | **[è¿ç§»]** ç§»é™¤ `searchMode` çŠ¶æ€            |
| `packages/types/src/data-library-types.ts`                                                   | [MODIFY] | æ–°å¢ `linkStatus` ç±»å‹å®šä¹‰                   |
| `apps/api/src/modules/data-management/data-asset.controller.ts`                              | [MODIFY] | æ–°å¢ `linkStatus` æŸ¥è¯¢å‚æ•°                   |
| `apps/api/src/modules/data-management/data-asset.service.ts`                                 | [MODIFY] | å®ç° unlinked è¿‡æ»¤é€»è¾‘                       |

### æŠ€æœ¯å†³ç­–

| Decision      | Choice                  | Rationale                          |
| ------------- | ----------------------- | ---------------------------------- |
| ç­›é€‰æ ä½ç½®    | å†…å®¹åŒºé¡¶éƒ¨ï¼ˆRow 2ï¼‰     | ç´§é‚»ç­›é€‰ç»“æœï¼Œå‡å°‘è®¤çŸ¥è·ç¦»         |
| æœç´¢èŒƒå›´å­˜å‚¨  | React Stateï¼ˆä¼šè¯çº§ï¼‰   | æ— éœ€æŒä¹…åŒ–ï¼Œåˆ·æ–°åé‡ç½®ç¬¦åˆç”¨æˆ·é¢„æœŸ |
| debounce æ—¶é—´ | 300ms                   | å¹³è¡¡å“åº”é€Ÿåº¦ä¸è¯·æ±‚é¢‘ç‡             |
| èŒƒå›´é€‰æ‹©å™¨ UI | Dropdown + å›¾æ ‡         | ä¸ç°æœ‰ UI é£æ ¼ä¸€è‡´                 |
| æ‰¹é‡æ“ä½œ      | å¤ç”¨ Story 9.8 è§£ç»‘é€»è¾‘ | å‡å°‘ä»£ç é‡å¤ï¼Œä¿æŒä¸€è‡´æ€§           |

### UI è®¾è®¡è§„æ ¼

> [!NOTE]
> è¯¦ç»† UI åŸå‹å·²åŒ…å«åœ¨ PRD ä¸­ï¼š[story-9-9-toolbar-redesign-prd.md](../plans/story-9-9-toolbar-redesign-prd.md)

**ç­›é€‰æ æ ·å¼ï¼š**
| å±æ€§   | å€¼                                   |
| ------ | ------------------------------------ |
| èƒŒæ™¯è‰² | `#FFFFFF`ï¼ˆäº®è‰²ï¼‰/ `#1F2937`ï¼ˆæš—è‰²ï¼‰ |
| è¾¹æ¡†   | `1px solid #E5E7EB`                  |
| åœ†è§’   | `8px`                                |
| é«˜åº¦   | `48px`                               |
| å†…è¾¹è· | `12px 16px`                          |

**æœç´¢è¾“å…¥æ¡†ï¼š**
| å±æ€§        | å€¼            |
| ----------- | ------------- |
| é«˜åº¦        | `36px`        |
| å®½åº¦        | `flex-1`      |
| Placeholder | `æœç´¢èµ„äº§...` |
| å›¾æ ‡        | ğŸ” å·¦ä¾§å†…ç½®    |

**èŒƒå›´é€‰æ‹©å™¨é€‰é¡¹ï¼š**
| é€‰é¡¹       | å›¾æ ‡ | æè¿°                       |
| ---------- | ---- | -------------------------- |
| å½“å‰èŠ‚ç‚¹   | ğŸ“    | æœç´¢å½“å‰é€‰ä¸­èŠ‚ç‚¹çš„å…³è”èµ„äº§ |
| å…¨éƒ¨èµ„äº§   | ğŸŒ    | æœç´¢æ•´ä¸ªå›¾è°±çš„æ‰€æœ‰èµ„äº§     |
| æœªå…³è”èµ„äº§ | ğŸ“    | æœç´¢æœªä¸ä»»ä½•èŠ‚ç‚¹å…³è”çš„èµ„äº§ |

### ä¸ç°æœ‰ Story çš„å…¼å®¹æ€§

| Story     | å½±å“ç¨‹åº¦ | å…¼å®¹ç­–ç•¥                             |
| --------- | -------- | ------------------------------------ |
| Story 9.1 | ğŸ”´ é«˜     | ä¿ç•™ Drawer æ ¸å¿ƒé€»è¾‘ï¼Œä»…é‡æ„ Toolbar |
| Story 9.2 | ğŸŸ¡ ä¸­     | Tab ç»„ä»¶ä¸å˜ï¼Œç­›é€‰é€»è¾‘æŠ½ç¦»           |
| Story 9.5 | ğŸŸ¢ ä½     | ä¸Šä¼ æŒ‰é’®ä¿ç•™åœ¨ Toolbar               |
| Story 9.7 | ğŸŸ¢ ä½     | ä¸Šä¼ ç±»å‹ä¸‹æ‹‰ä¿ç•™åœ¨ Toolbar           |
| Story 9.8 | ğŸŸ¡ ä¸­     | è§£å†³åŒæœç´¢çŠ¶æ€æ­§ä¹‰ï¼›å¤ç”¨è§£ç»‘é€»è¾‘     |

### çŠ¶æ€ç®¡ç†è®¾è®¡

```typescript
// æ–°çŠ¶æ€è®¾è®¡ï¼ˆè¡¥å……ç°æœ‰ DataLibraryDrawerStateï¼‰
interface AssetFilterState {
  // èµ„äº§ç­›é€‰ï¼ˆå³ä¾§ç­›é€‰æ ï¼‰
  assetSearchQuery: string;
  searchScope: 'current-node' | 'all' | 'unlinked';
  formatFilter: DataAssetFormat | '';
  createdAfter: string;
  createdBefore: string;
}

// ä½¿ç”¨æ–¹å¼
const {
  filterState,
  setAssetSearchQuery,
  setSearchScope,
  setFormatFilter,
  setDateRange,
  clearAllFilters,
  activeFilterCount,
} = useAssetFilterState();
```

### æœç´¢è¿ç§»è®¡åˆ’ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

> [!IMPORTANT]
> æœ¬ Story çš„æ ¸å¿ƒç›®æ ‡ä¹‹ä¸€æ˜¯å½»åº•æ¶ˆé™¤â€œèŠ‚ç‚¹æœç´¢ vs èµ„äº§æœç´¢â€çš„åŒå…¥å£ä¸åŒçŠ¶æ€ã€‚

1. **å·¦ä¾§ç»„ç»‡é¢æ¿ï¼šä»…èŠ‚ç‚¹æœç´¢**
   - ç§»é™¤/ç¦ç”¨å·¦ä¾§ `DualSearch` çš„ã€Œèµ„äº§ã€æ¨¡å¼ä¸åˆ‡æ¢ UIï¼Œåªä¿ç•™èŠ‚ç‚¹æœç´¢è¾“å…¥æ¡†
   - èŠ‚ç‚¹æœç´¢çŠ¶æ€ä½¿ç”¨ `nodeSearchQuery`ï¼ˆä»…å½±å“æ ‘è¿‡æ»¤/é«˜äº®/å±•å¼€ï¼Œä¸è§¦å‘ `data-assets` è¯·æ±‚ï¼‰
2. **å³ä¾§å†…å®¹åŒºï¼šä»…èµ„äº§ç­›é€‰æ **
   - Toolbar ä¸å†æ‰¿è½½ä»»ä½•ç­›é€‰æ§ä»¶ï¼ˆAC1ï¼‰
   - èµ„äº§ç­›é€‰çŠ¶æ€ä½¿ç”¨ `assetSearchQuery` + `searchScope` + `format/date`
3. **æŒ‰ `searchScope` åˆ†æµæ•°æ®æ¥æºï¼ˆAC3ï¼‰**
   - `current-node`ï¼šå¤ç”¨èŠ‚ç‚¹å…³è”æ•°æ®æºï¼ˆå•èŠ‚ç‚¹ï¼š`useAssetLinks`ï¼›å¤šèŠ‚ç‚¹ï¼š`useSelectedNodesAssets`ï¼‰ï¼Œå¹¶åœ¨å‰ç«¯å¯¹è¿”å›èµ„äº§åº”ç”¨æœç´¢/ç±»å‹/æ—¥æœŸè¿‡æ»¤
   - `all`ï¼šä½¿ç”¨ `useDataAssets({ search, format, createdAfter, createdBefore })`ï¼Œä»¥æ‰å¹³åˆ—è¡¨å±•ç¤ºï¼ˆéšè— linkType åˆ†ç»„ï¼‰
   - `unlinked`ï¼šä½¿ç”¨ `useDataAssets({ ..., linkStatus: 'unlinked' })`ï¼Œä»¥æ‰å¹³åˆ—è¡¨å±•ç¤ºï¼ˆéšè— linkType åˆ†ç»„ï¼‰
4. **çŠ¶æ€éš”ç¦»ä¸é‡ç½®è§„åˆ™ï¼ˆAC4/AC5ï¼‰**
   - åˆ‡æ¢èŠ‚ç‚¹ï¼šèµ„äº§ç­›é€‰ä¿æŒä¸å˜å¹¶åº”ç”¨åˆ°æ–°èŠ‚ç‚¹
   - åˆ‡æ¢è§†è§’ï¼ˆèŠ‚ç‚¹â†”æ–‡ä»¶å¤¹ï¼‰ï¼šèµ„äº§ç­›é€‰æ¸…ç©ºå¹¶ Toast æç¤ºã€Œç­›é€‰å·²é‡ç½®ã€
   - `nodeSearchQuery` ä¸ `assetSearchQuery` æ°¸è¿œäº’ä¸å½±å“

### ä¸ Story 9.8 çš„å…³ç³»

æœ¬ Story è§£å†³ Story 9.8 å®ç°åé—ç•™çš„ä»¥ä¸‹é—®é¢˜ï¼š

1. **åŒæœç´¢æ­§ä¹‰**ï¼šStory 9.8 ä¿ç•™äº†å·¦ä¾§èŠ‚ç‚¹æœç´¢å’Œå³ä¾§ Toolbar èµ„äº§æœç´¢ï¼Œä½†æœªæ˜ç¡®åŒºåˆ†
2. **ç­›é€‰æ§ä»¶ä½ç½®**ï¼šStory 9.8 æœªè°ƒæ•´ Toolbar ç»“æ„ï¼Œç­›é€‰æ§ä»¶ä»ä¸æ“ä½œæŒ‰é’®æ··åˆ
3. **æœç´¢èŒƒå›´é€‰æ‹©**ï¼šStory 9.8 çš„èµ„äº§æœç´¢é»˜è®¤ä¸ºå…¨å±€ï¼Œç¼ºå°‘"å½“å‰èŠ‚ç‚¹/å…¨éƒ¨/æœªå…³è”"çš„èŒƒå›´é€‰æ‹©

### Project Structure Notes

- æ–°å¢ç»„ä»¶ç›®å½•ï¼š`apps/web/features/data-library/components/asset-filter/`
- æ–°å¢ Hookï¼š`useAssetFilterState`
- å¤ç”¨ç°æœ‰ï¼š`DataLibraryDrawer`ã€`useNodeAssetUnlink`ã€`GroupedAssetList`

### References

- [story-9-9-toolbar-redesign-prd.md](../plans/story-9-9-toolbar-redesign-prd.md) - å®Œæ•´ PRD + UI åŸå‹
- [9-8-node-view-merge.md](./9-8-node-view-merge.md) - å‰ç½® Storyï¼ˆèŠ‚ç‚¹è§†å›¾åˆå¹¶ï¼‰
- [tech-spec-9-8-node-view-merge.md](./tech-spec-9-8-node-view-merge.md) - Story 9.8 æŠ€æœ¯è§„æ ¼
- [architecture.md](../architecture.md) - æ•°æ®ç®¡ç†æ¶æ„
- [project-context.md](../project-context.md) - é¡¹ç›®ä¸Šä¸‹æ–‡ä¸ç¼–ç è§„èŒƒ
- [DataLibraryDrawerToolbar.tsx](../../apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerToolbar.tsx) - å¾…é‡æ„çš„ Toolbar ç»„ä»¶
- [DataLibraryDrawerContent.tsx](../../apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerContent.tsx) - ç­›é€‰æ é›†æˆè½ç‚¹
- [useDataAssets.ts](../../apps/web/features/data-library/hooks/useDataAssets.ts) - èµ„äº§æŸ¥è¯¢ Hook
- [useNodeAssetUnlink.ts](../../apps/web/features/data-library/hooks/useNodeAssetUnlink.ts) - è§£ç»‘ + Undo Toastï¼ˆå¤ç”¨ï¼‰

## Test Design

### æµ‹è¯•è¦†ç›–çŸ©é˜µ

| AC  | éªŒæ”¶è¦æ±‚                   | å•å…ƒæµ‹è¯• | é›†æˆæµ‹è¯• | E2E æµ‹è¯• |
| --- | -------------------------- | -------- | -------- | -------- |
| AC1 | Toolbar ç²¾ç®€ï¼ˆæ“ä½œç±»èšç„¦ï¼‰ | UT-4     | IT-1     | E2E-1    |
| AC2 | èµ„äº§ç­›é€‰æ                  | UT-1     | IT-2     | E2E-2    |
| AC3 | æœç´¢èŒƒå›´é€‰æ‹©å™¨             | UT-2     | IT-4     | E2E-4    |
| AC4 | ç­›é€‰çŠ¶æ€è¡Œä¸º               | UT-3     | IT-3     | E2E-3    |
| AC5 | å·¦ä¾§èŠ‚ç‚¹æœç´¢å¢å¼º           | UT-5     | IT-5     | E2E-5    |
| AC6 | æ‰¹é‡æ“ä½œå¢å¼º               | -        | IT-6     | E2E-6    |

### æµ‹è¯•æ–‡ä»¶ç»“æ„

```
apps/web/features/data-library/
â”œâ”€â”€ __tests__/
â”‚   â”œâ”€â”€ AssetFilterBar.test.tsx       # [NEW] ç­›é€‰æ ç»„ä»¶æµ‹è¯• (UT-1)
â”‚   â”œâ”€â”€ ToolbarRedesign.test.tsx      # [NEW] Toolbar é‡æ„æµ‹è¯• (UT-4)
â”‚   â””â”€â”€ NodeSearchEnhancement.test.tsx # [NEW] èŠ‚ç‚¹æœç´¢å¢å¼ºæµ‹è¯• (UT-5)
â”œâ”€â”€ hooks/__tests__/
â”‚   â””â”€â”€ useAssetFilterState.test.ts   # [NEW] ç­›é€‰çŠ¶æ€ Hook æµ‹è¯• (UT-3)
â””â”€â”€ components/asset-filter/__tests__/
    â”œâ”€â”€ ScopeSelector.test.tsx        # [NEW] èŒƒå›´é€‰æ‹©å™¨æµ‹è¯• (UT-2)
    â””â”€â”€ TypeFilter.test.tsx           # [NEW] ç±»å‹ç­›é€‰æµ‹è¯•
```

---

### å•å…ƒæµ‹è¯• (Unit Tests)

#### UT-1: AssetFilterBar ç»„ä»¶ (AC2)

| Test ID | æµ‹è¯•ç”¨ä¾‹          | é¢„æœŸç»“æœ                               | AC éªŒè¯ç‚¹            |
| ------- | ----------------- | -------------------------------------- | -------------------- |
| UT-1.1  | æ¸²æŸ“æ‰€æœ‰ç­›é€‰æ§ä»¶  | æœç´¢æ¡†ã€èŒƒå›´ã€ç±»å‹ã€æ—¥æœŸå‡å¯è§         | AC2: åŒ…å«æ‰€æœ‰æ§ä»¶    |
| UT-1.2  | æœç´¢è¾“å…¥ debounce | è¾“å…¥å 300ms è§¦å‘ onChange             | AC2: 300ms debounce  |
| UT-1.3  | æ¸…é™¤ç­›é€‰æŒ‰é’®      | ç‚¹å‡»åæ‰€æœ‰ç­›é€‰é‡ç½®                     | AC2: æ¸…é™¤ç­›é€‰æŒ‰é’®    |
| UT-1.4  | ç­›é€‰å¾½ç« æ˜¾ç¤º      | è®¾ç½® 2 ä¸ªç­›é€‰åæ˜¾ç¤ºã€Œå·²åº”ç”¨ 2 ä¸ªç­›é€‰ã€ | AC2: å·²åº”ç”¨ N ä¸ªç­›é€‰ |
| UT-1.5  | ç­›é€‰æ é«˜åº¦é™åˆ¶    | ç»„ä»¶é«˜åº¦ â‰¤ 48px                        | AC2: é«˜åº¦ â‰¤ 48px     |
| UT-1.6  | ç­›é€‰å®æ—¶æ›´æ–°      | è®¾ç½®ç­›é€‰ååˆ—è¡¨è‡ªåŠ¨åˆ·æ–°ï¼ˆæ— éœ€æ‰‹åŠ¨ï¼‰     | AC2: å®æ—¶æ›´æ–°        |

#### UT-2: ScopeSelector ç»„ä»¶ (AC3)

| Test ID | æµ‹è¯•ç”¨ä¾‹             | é¢„æœŸç»“æœ                              | AC éªŒè¯ç‚¹     |
| ------- | -------------------- | ------------------------------------- | ------------- |
| UT-2.1  | é»˜è®¤å€¼ä¸ºã€Œå½“å‰èŠ‚ç‚¹ã€ | åˆå§‹é€‰ä¸­ã€Œå½“å‰èŠ‚ç‚¹ã€                  | AC3: é»˜è®¤å€¼   |
| UT-2.2  | åˆ‡æ¢èŒƒå›´è§¦å‘å›è°ƒ     | ç‚¹å‡»é€‰é¡¹åè§¦å‘ onChange               | AC3: åˆ‡æ¢èŒƒå›´ |
| UT-2.3  | æ˜¾ç¤ºä¸‰ä¸ªé€‰é¡¹         | ä¸‹æ‹‰åŒ…å« å½“å‰èŠ‚ç‚¹/å…¨éƒ¨èµ„äº§/æœªå…³è”èµ„äº§ | AC3: ä¸‰ä¸ªé€‰é¡¹ |
| UT-2.4  | é€‰é¡¹åŒ…å«å›¾æ ‡         | æ¯ä¸ªé€‰é¡¹æ˜¾ç¤ºå¯¹åº”å›¾æ ‡ ğŸ“/ğŸŒ/ğŸ“            | AC3: é€‰é¡¹å›¾æ ‡ |

#### UT-3: useAssetFilterState Hook (AC4)

| Test ID | æµ‹è¯•ç”¨ä¾‹               | é¢„æœŸç»“æœ                                | AC éªŒè¯ç‚¹         |
| ------- | ---------------------- | --------------------------------------- | ----------------- |
| UT-3.1  | åˆå§‹çŠ¶æ€ä¸ºç©º           | æ‰€æœ‰ç­›é€‰å­—æ®µä¸ºé»˜è®¤å€¼                    | AC4: åˆå§‹çŠ¶æ€     |
| UT-3.2  | è®¾ç½®æœç´¢å…³é”®è¯         | `assetSearchQuery` æ›´æ–°                 | AC4: çŠ¶æ€ç®¡ç†     |
| UT-3.3  | è®¾ç½®èŒƒå›´               | `searchScope` æ›´æ–°                      | AC4: çŠ¶æ€ç®¡ç†     |
| UT-3.4  | æ¸…ç©ºæ‰€æœ‰ç­›é€‰           | è°ƒç”¨ `clearAllFilters` åé‡ç½®           | AC4: æ¸…ç©ºçŠ¶æ€     |
| UT-3.5  | è®¡ç®— activeFilterCount | è®¾ç½® 2 ä¸ªç­›é€‰åè¿”å› 2                   | AC2: å¾½ç« è®¡æ•°     |
| UT-3.6  | åˆ‡æ¢è§†è§’æ—¶æ¸…ç©º         | è°ƒç”¨ `resetOnViewChange()` æ¸…ç©ºæ‰€æœ‰ç­›é€‰ | AC4: åˆ‡æ¢è§†è§’æ¸…ç©º |

#### UT-4: DataLibraryDrawerToolbar é‡æ„ (AC1)

| Test ID | æµ‹è¯•ç”¨ä¾‹         | é¢„æœŸç»“æœ                          | AC éªŒè¯ç‚¹         |
| ------- | ---------------- | --------------------------------- | ----------------- |
| UT-4.1  | ä¸åŒ…å«æœç´¢æ¡†     | Toolbar å†…æ—  input[type="search"] | AC1: ç§»é™¤æœç´¢æ¡†   |
| UT-4.2  | ä¸åŒ…å«ç±»å‹ç­›é€‰   | Toolbar å†…æ— ç±»å‹ä¸‹æ‹‰é€‰æ‹©å™¨        | AC1: ç§»é™¤ç±»å‹ç­›é€‰ |
| UT-4.3  | ä¸åŒ…å«æ—¥æœŸèŒƒå›´   | Toolbar å†…æ— æ—¥æœŸé€‰æ‹©å™¨            | AC1: ç§»é™¤æ—¥æœŸèŒƒå›´ |
| UT-4.4  | åŒ…å«ä¸Šä¼ æŒ‰é’®     | ä¸Šä¼ æŒ‰é’®å¯è§                      | AC1: ä¿ç•™æ“ä½œç±»   |
| UT-4.5  | åŒ…å«å›æ”¶ç«™æŒ‰é’®   | å›æ”¶ç«™æŒ‰é’®å¯è§                    | AC1: ä¿ç•™æ“ä½œç±»   |
| UT-4.6  | åŒ…å«è§†å›¾åˆ‡æ¢     | ç½‘æ ¼/åˆ—è¡¨åˆ‡æ¢å¯è§                 | AC1: ä¿ç•™è§†å›¾æ§åˆ¶ |
| UT-4.7  | Toolbar é«˜åº¦é™åˆ¶ | ç»„ä»¶é«˜åº¦ â‰¤ 56px                   | AC1: é«˜åº¦ â‰¤ 56px  |
| UT-4.8  | æ§ä»¶æ•°é‡é™åˆ¶     | æ§ä»¶æ€»æ•° â‰¤ 6                      | AC1: æ§ä»¶ â‰¤ 6 ä¸ª  |

#### UT-5: èŠ‚ç‚¹æœç´¢å¢å¼º (AC5)

| Test ID | æµ‹è¯•ç”¨ä¾‹     | é¢„æœŸç»“æœ                                  | AC éªŒè¯ç‚¹         |
| ------- | ------------ | ----------------------------------------- | ----------------- |
| UT-5.1  | å¸®åŠ©æ–‡å­—æ˜¾ç¤º | æœç´¢æ¡†ä¸‹æ–¹æ˜¾ç¤ºã€Œåœ¨ PBS å’Œä»»åŠ¡èŠ‚ç‚¹ä¸­æœç´¢ã€ | AC5: å¸®åŠ©æç¤º     |
| UT-5.2  | èŠ‚ç‚¹æœç´¢åŠŸèƒ½ | è¾“å…¥å…³é”®è¯åè¿‡æ»¤èŠ‚ç‚¹æ ‘                    | AC5: ä¿æŒç°æœ‰åŠŸèƒ½ |
| UT-5.3  | æ¸…ç©ºæœç´¢æ¢å¤ | æ¸…ç©ºæœç´¢åæ˜¾ç¤ºå®Œæ•´èŠ‚ç‚¹æ ‘                  | AC5: æ¸…ç©ºæ¢å¤     |

---

### é›†æˆæµ‹è¯• (Integration Tests)

#### IT-1: Toolbar ç²¾ç®€ (AC1)

| Test ID | æµ‹è¯•ç”¨ä¾‹           | é¢„æœŸç»“æœ                                                       |
| ------- | ------------------ | -------------------------------------------------------------- |
| IT-1.1  | æ‰“å¼€ Drawer        | Toolbar åªåŒ…å«æ“ä½œæŒ‰é’®                                         |
| IT-1.2  | æœç´¢æ¡†ä¸åœ¨ Toolbar | `[data-testid="toolbar"] >> input[placeholder*="æœç´¢"]` ä¸å­˜åœ¨ |
| IT-1.3  | ä¸Šä¼ æŒ‰é’®å­˜åœ¨       | å¯è§ä¸”å¯ç‚¹å‡»                                                   |
| IT-1.4  | å›æ”¶ç«™æŒ‰é’®å­˜åœ¨     | å¯è§ä¸”å¯ç‚¹å‡»                                                   |

#### IT-2: èµ„äº§ç­›é€‰æ  (AC2)

| Test ID | æµ‹è¯•ç”¨ä¾‹     | é¢„æœŸç»“æœ                              |
| ------- | ------------ | ------------------------------------- |
| IT-2.1  | ç­›é€‰æ å¯è§   | `data-testid="asset-filter-bar"` å­˜åœ¨ |
| IT-2.2  | æœç´¢èµ„äº§     | è¾“å…¥å…³é”®è¯åè¿‡æ»¤èµ„äº§åˆ—è¡¨              |
| IT-2.3  | ç±»å‹ç­›é€‰     | é€‰æ‹© STEP ååªæ˜¾ç¤º STEP ç±»å‹èµ„äº§      |
| IT-2.4  | æ—¥æœŸèŒƒå›´ç­›é€‰ | è®¾ç½®æ—¥æœŸèŒƒå›´åè¿‡æ»¤èµ„äº§åˆ—è¡¨            |

#### IT-3: ç­›é€‰çŠ¶æ€è¡Œä¸º (AC4)

| Test ID | æµ‹è¯•ç”¨ä¾‹         | é¢„æœŸç»“æœ                                 |
| ------- | ---------------- | ---------------------------------------- |
| IT-3.1  | åˆ‡æ¢èŠ‚ç‚¹ä¿æŒç­›é€‰ | æœç´¢å…³é”®è¯åœ¨èŠ‚ç‚¹åˆ‡æ¢åä¿ç•™               |
| IT-3.2  | åˆ‡æ¢è§†è§’æ¸…ç©ºç­›é€‰ | ä»èŠ‚ç‚¹è§†å›¾åˆ‡åˆ°æ–‡ä»¶å¤¹è§†å›¾åæœç´¢æ¡†æ¸…ç©º     |
| IT-3.3  | è§†è§’åˆ‡æ¢ Toast   | æ˜¾ç¤ºã€Œç­›é€‰å·²é‡ç½®ã€æç¤º                   |
| IT-3.4  | Drawer å…³é—­/é‡å¼€ | é‡æ–°æ‰“å¼€ Drawer åç­›é€‰æ¡ä»¶ä¿æŒï¼ˆä¼šè¯å†…ï¼‰ |

#### IT-4: æœç´¢èŒƒå›´é€‰æ‹©å™¨ (AC3)

| Test ID | æµ‹è¯•ç”¨ä¾‹         | é¢„æœŸç»“æœ                                           |
| ------- | ---------------- | -------------------------------------------------- |
| IT-4.1  | åˆ‡æ¢èŒƒå›´åˆ·æ–°ç»“æœ | é€‰æ‹©ã€Œå…¨éƒ¨èµ„äº§ã€åç«‹å³åˆ·æ–°æ˜¾ç¤ºå…¨éƒ¨èµ„äº§             |
| IT-4.2  | å…¨å±€æœç´¢éšè—åˆ†ç»„ | é€‰æ‹©ã€Œå…¨éƒ¨èµ„äº§ã€æ—¶éšè— Input/Output/Reference åˆ†ç»„ |
| IT-4.3  | æœªå…³è”èµ„äº§ç­›é€‰   | é€‰æ‹©ã€Œæœªå…³è”èµ„äº§ã€åªæ˜¾ç¤ºæœªä¸èŠ‚ç‚¹å…³è”çš„èµ„äº§         |

#### IT-5: å·¦ä¾§èŠ‚ç‚¹æœç´¢å¢å¼º (AC5)

| Test ID | æµ‹è¯•ç”¨ä¾‹     | é¢„æœŸç»“æœ                       |
| ------- | ------------ | ------------------------------ |
| IT-5.1  | å¸®åŠ©æç¤ºå¯è§ | èŠ‚ç‚¹æœç´¢æ¡†ä¸‹æ–¹æ˜¾ç¤ºå¸®åŠ©æ–‡å­—     |
| IT-5.2  | èŠ‚ç‚¹æœç´¢ç‹¬ç«‹ | èŠ‚ç‚¹æœç´¢ä¸å½±å“èµ„äº§ç­›é€‰æ çš„çŠ¶æ€ |
| IT-5.3  | èµ„äº§æœç´¢ç‹¬ç«‹ | èµ„äº§æœç´¢ä¸å½±å“èŠ‚ç‚¹æœç´¢æ¡†çš„çŠ¶æ€ |
| IT-5.4  | é«˜äº®åŒ¹é…èŠ‚ç‚¹ | æœç´¢åå‘½ä¸­èŠ‚ç‚¹æ–‡æœ¬é«˜äº®æ˜¾ç¤º     |
| IT-5.5  | å±•å¼€å‘½ä¸­è·¯å¾„ | æœç´¢åè‡ªåŠ¨å±•å¼€å‘½ä¸­èŠ‚ç‚¹çš„çˆ¶è·¯å¾„ |

#### IT-6: æ‰¹é‡æ“ä½œå¢å¼º (AC6)

| Test ID | æµ‹è¯•ç”¨ä¾‹         | é¢„æœŸç»“æœ                                           |
| ------- | ---------------- | -------------------------------------------------- |
| IT-6.1  | æ‰¹é‡åˆ é™¤æŒ‰é’®æ ·å¼ | æ‰¹é‡åˆ é™¤æŒ‰é’®ä½¿ç”¨çº¢è‰²è­¦ç¤ºè‰²                         |
| IT-6.2  | æ‰¹é‡è§£ç»‘è€Œéåˆ é™¤ | ç‚¹å‡»æ‰¹é‡åˆ é™¤åè°ƒç”¨è§£ç»‘ APIï¼Œèµ„äº§ä»å­˜åœ¨äºæ–‡ä»¶å¤¹è§†å›¾ |
| IT-6.3  | Undo Toast æ˜¾ç¤º  | æ‰¹é‡è§£ç»‘åæ˜¾ç¤ºã€Œå·²è§£é™¤ N ä¸ªå…³è”ã€+ æ’¤é”€æŒ‰é’®        |
| IT-6.4  | Undo æ’¤é”€åŠŸèƒ½    | ç‚¹å‡»æ’¤é”€åæ¢å¤å…³è”                                 |

---

### E2E æµ‹è¯• (Playwright)

| Test ID | æµ‹è¯•åœºæ™¯             | éªŒè¯æ­¥éª¤                                                                                                                       | AC  |
| ------- | -------------------- | ------------------------------------------------------------------------------------------------------------------------------ | --- |
| E2E-1   | Toolbar æ“ä½œæŒ‰é’®æ­£å¸¸ | 1. æ‰“å¼€ Drawer<br>2. éªŒè¯ä¸Šä¼ /å›æ”¶ç«™æŒ‰é’®å­˜åœ¨<br>3. éªŒè¯æœç´¢æ¡†ä¸åœ¨ Toolbar<br>4. éªŒè¯ Toolbar é«˜åº¦ â‰¤56px                        | AC1 |
| E2E-2   | ç­›é€‰æ æœç´¢+ç­›é€‰è”åŠ¨  | 1. æ‰“å¼€ Drawer<br>2. è¾“å…¥æœç´¢å…³é”®è¯<br>3. é€‰æ‹©ç±»å‹ç­›é€‰<br>4. éªŒè¯èµ„äº§åˆ—è¡¨è¿‡æ»¤<br>5. éªŒè¯ç­›é€‰å¾½ç« æ˜¾ç¤º                           | AC2 |
| E2E-3   | è§†è§’åˆ‡æ¢ç­›é€‰é‡ç½®     | 1. åœ¨èŠ‚ç‚¹è§†å›¾è¾“å…¥æœç´¢<br>2. åˆ‡æ¢åˆ°æ–‡ä»¶å¤¹è§†å›¾<br>3. éªŒè¯æœç´¢æ¡†æ¸…ç©º<br>4. éªŒè¯ Toast æç¤º                                        | AC4 |
| E2E-4   | æœç´¢èŒƒå›´åˆ‡æ¢         | 1. æ‰“å¼€èŠ‚ç‚¹è§†å›¾<br>2. é€‰ä¸­ä¸€ä¸ªèŠ‚ç‚¹<br>3. åˆ‡æ¢èŒƒå›´åˆ°ã€Œå…¨éƒ¨èµ„äº§ã€<br>4. éªŒè¯ç»“æœåˆ·æ–°<br>5. éªŒè¯éšè— linkType åˆ†ç»„                | AC3 |
| E2E-5   | èŠ‚ç‚¹æœç´¢å¢å¼º         | 1. æ‰“å¼€èŠ‚ç‚¹è§†å›¾<br>2. éªŒè¯å¸®åŠ©æ–‡å­—æ˜¾ç¤º<br>3. è¾“å…¥èŠ‚ç‚¹æœç´¢å…³é”®è¯<br>4. éªŒè¯èŠ‚ç‚¹æ ‘ç­›é€‰<br>5. åœ¨èµ„äº§ç­›é€‰æ æœç´¢<br>6. éªŒè¯ä¸¤è€…ç‹¬ç«‹ | AC5 |
| E2E-6   | æ‰¹é‡è§£ç»‘æ“ä½œ         | 1. é€‰ä¸­å¤šä¸ªèŠ‚ç‚¹<br>2. é€‰ä¸­å¤šä¸ªèµ„äº§<br>3. ç‚¹å‡»æ‰¹é‡åˆ é™¤æŒ‰é’®<br>4. éªŒè¯ Undo Toast<br>5. ç‚¹å‡»æ’¤é”€<br>6. éªŒè¯å…³è”æ¢å¤              | AC6 |

---

### æµ‹è¯•å‘½ä»¤æ±‡æ€»

```bash
# è¿è¡Œæ‰€æœ‰ Story 9.9 ç›¸å…³å•å…ƒæµ‹è¯•
cd apps/web && pnpm test -- -t "Story 9.9"

# è¿è¡ŒæŒ‡å®šæµ‹è¯•æ–‡ä»¶ï¼ˆVitestï¼‰
cd apps/web && pnpm test -- features/data-library/__tests__/AssetFilterBar.test.tsx
cd apps/web && pnpm test -- features/data-library/components/asset-filter/__tests__/ScopeSelector.test.tsx
cd apps/web && pnpm test -- features/data-library/hooks/__tests__/useAssetFilterState.test.ts
cd apps/web && pnpm test -- features/data-library/__tests__/ToolbarRedesign.test.tsx
cd apps/web && pnpm test -- features/data-library/__tests__/NodeSearchEnhancement.test.tsx

# è¿è¡Œ E2E æµ‹è¯•
cd apps/web && pnpm test:e2e -- e2e/toolbar-redesign.spec.ts
```

## Dev Agent Record

### Validation Applied

- âœ… [2026-01-14] `validate-create-story` å·²æ‰§è¡Œå¹¶åº”ç”¨æ”¹è¿›
  - å¢å¼º Task 4ï¼šæ·»åŠ  unlinked API è¯¦ç»†è§„æ ¼
  - å¢å¼º Task 5ï¼šæ·»åŠ  DualSearch è¿ç§»å­ä»»åŠ¡ (5.5-5.8)
  - å¢å¼º Task 7ï¼šæ·»åŠ ç°æœ‰æµ‹è¯•æ›´æ–°æ¸…å• (7.4-7.5)
  - å¢å¼º Task 8ï¼šæ·»åŠ ç°æœ‰ E2E æµ‹è¯•æ›´æ–° (8.4)
  - æ›´æ–°æ–‡ä»¶è½ç‚¹è¡¨ï¼šæ–°å¢è¿ç§»å’Œåç«¯æ–‡ä»¶

### Agent Model Used

GPT-5.2 (Codex CLI)

### Debug Log References

### Completion Notes List

- âœ… [2026-01-14] ä¿®å¤ AC2/AC3ï¼šNode è§†å›¾ç­›é€‰å¯¹å…³è”èµ„äº§ç”Ÿæ•ˆï¼›Scope åˆ‡æ¢æ­£ç¡®åˆ‡æ¢æ•°æ®æºå¹¶éšè— linkType åˆ†ç»„
- âœ… [2026-01-14] ä¿®å¤ã€Œæœªå…³è”èµ„äº§ã€èŒƒå›´ï¼š`linkStatus=unlinked` è´¯é€š Types â†’ API â†’ Backend â†’ UI
- âœ… [2026-01-14] ä¿®å¤åŒé‡ debounceï¼šæ•´ä½“ä¿æŒ 300ms
- âœ… [2026-01-14] DualSearch ç®€åŒ–ä¸º NodeSearchï¼ˆç§»é™¤ asset modeï¼‰
- âœ… [2026-01-14] æ›´æ–° Web å•æµ‹ï¼ˆDataLibraryDrawer/OrganizationViewsï¼‰+ æ–°å¢åç«¯ä»“å‚¨å•æµ‹è¦†ç›– linkStatus
- âœ… [2026-01-14] è¡¥é½ UTï¼šDualSearchï¼ˆNodeSearch-onlyï¼‰å¹¶é€šè¿‡
- âœ… [2026-01-14] è¡¥é½ E2Eï¼štoolbar-redesign + æ›´æ–° data-library.spec.tsï¼Œå¹¶é€šè¿‡

### File List

- apps/web/features/data-library/components/DataLibraryDrawer.tsx
- apps/web/features/data-library/components/OrganizationTabs.tsx
- apps/web/features/data-library/components/__tests__/OrganizationTabs.test.tsx
- apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerContent.tsx
- apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerPanel.tsx
- apps/web/features/data-library/components/data-library-drawer/DataLibraryDrawerToolbar.tsx
- apps/web/features/data-library/components/asset-filter/AssetFilterBar.tsx
- apps/web/features/data-library/components/asset-filter/ScopeSelector.tsx
- apps/web/features/data-library/components/asset-filter/TypeFilter.tsx
- apps/web/features/data-library/components/asset-filter/DateRangeFilter.tsx
- apps/web/features/data-library/components/asset-filter/FilterBadge.tsx
- apps/web/features/data-library/components/asset-filter/index.ts
- apps/web/features/data-library/components/asset-filter/types.ts
- apps/web/features/data-library/components/node-tree/NodeSearch.tsx
- apps/web/features/data-library/components/node-tree/index.ts
- apps/web/features/data-library/hooks/useAssetFilterState.ts
- apps/web/features/data-library/hooks/useAssetDelete.ts
- apps/web/features/data-library/hooks/useDataAssets.ts
- apps/web/features/data-library/hooks/index.ts
- apps/web/features/data-library/api/data-assets.ts
- apps/web/__tests__/features/data-library/AssetFilterBar.test.tsx
- apps/web/__tests__/features/data-library/ScopeSelector.test.tsx
- apps/web/__tests__/features/data-library/DualSearch.test.tsx
- apps/web/__tests__/features/data-library/useAssetFilterState.test.ts
- apps/web/features/data-library/__tests__/DataLibraryDrawer.test.tsx
- apps/web/features/data-library/__tests__/OrganizationViews.test.tsx
- apps/web/e2e/toolbar-redesign.spec.ts
- apps/web/e2e/data-library.spec.ts
- packages/types/src/data-library-types.ts
- apps/api/src/modules/data-management/data-asset.controller.ts
- apps/api/src/modules/data-management/data-asset.repository.ts
- apps/api/src/modules/data-management/__tests__/data-asset.repository.spec.ts
- docs/sprint-artifacts/9-9-toolbar-redesign.md
- docs/sprint-artifacts/sprint-status.yaml
